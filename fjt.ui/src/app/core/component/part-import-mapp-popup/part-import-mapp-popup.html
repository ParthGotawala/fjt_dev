<md-dialog aria-label="manage-rfq-lineitem-headers" flex="95" cg-busy="{promise:vm.cgBusyLoading}" draggable>
  <form name="vm.manufacturerMapping">
    <md-toolbar>
      <div class="md-toolbar-tools" layout="row" layout-align="space-between center">
        <h2>{{vm.LabelConstant.MFGPN}} Status</h2>
        <span flex></span>
        <md-button class="md-icon-button" ng-click="vm.cancel()">
          <md-icon role="img" md-font-icon="icon-close" class="material-icons mat-icon icon-close"></md-icon>
        </md-button>
      </div>
    </md-toolbar>
    <md-dialog-content class="customer-modal no-padding" layout="column">
      <md-content class="md-padding custom-scroll">
        <ms-form-wizard flex>
          <md-tabs validate-step="true" is-valid="vm.isStepValid" class="fielddetail manage-department-tabing padding-0"
                   md-dynamic-height md-selected="msWizard.selectedIndex">
            <md-tab md-on-select="vm.onTabChanges(msWizard)">
              <md-tab-label>
                <span class="ms-form-wizard-step-label">
                  <span class="ms-form-wizard-step-text">Mapping Pending ({{vm.apiErrorList.length}})</span>
                </span>
              </md-tab-label>
              <md-tab-body>
                <div layout="row" flex="40" flex-lg="50" flex-sm="100">
                  <div class="cm-section-main border-0" layout="row" layout-wrap flex="100">
                    <div class="cm-section-inner" flex="100">
                      <div flex="100" layout="row" class="padding-10 layout-row flex-100 cm-padding-left-5-imp">
                        <div class="input-wrapper">
                          <div layout="row">
                            <p class="label-container">Search</p>
                            <md-radio-group class="margin-left-15" layout="row" ng-model="vm.allMfgsModel.searchType" ng-change="vm.changeSearchType()">
                              <md-radio-button ng-value="vm.CustomSearchTypeForList.Contains" class="md-primary margin-top-0">Contains</md-radio-button>
                              <md-radio-button ng-value="vm.CustomSearchTypeForList.Exact" class="md-primary margin-right-10 margin-top-0">Exact</md-radio-button>
                            </md-radio-group>
                          </div>
                        </div>
                        <div layout="row" flex>
                          <div layout="row" class="input-wrapper" flex>
                            <md-input-container class="margin-top-0 md-block margin-right-10" flex="100" md-no-float>
                              <input type="text" name="search" ng-model="vm.allMfgsModel.searchText"
                                     placeholder="Type here to search" maxlength="100" ng-change="vm.searchPendingList(vm.allMfgsModel.searchText)"
                                     ng-model-options="{debounce: vm.debounceTime }">
                            </md-input-container>
                          </div>
                          <div>
                            <md-button class="md-primary md-raised margin-0 margin-left-5-imp" ng-click="vm.removeErrorListFilter(true);"
                                       aria-label="Reset">Reset</md-button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <md-card class="margin-0 cm-mfg-grid-title" layout="column" layout-align="space-between stretch" flex="100">
                  <md-table-container flex="100" class="mh-10 mb-10">
                    <table md-table class="md-data-table table-row-select cm-manufacturer-table" md-row-select ng-model="vm.selectedItems">
                      <thead md-head md-order="vm.errorOrder">
                        <tr md-row>
                          <th class="cm-mnf-action" md-column>Action</th>
                          <th class="cm-mnf-no">#</th>
                          <th class="cm-mnf-ex-name" md-column md-order-by="importMfrName">Import {{vm.LabelConstant.MFG}}</th>
                          <th class="cm-mnf-code" md-column md-order-by="importMfrName">{{vm.LabelConstant.MFG}}</th>
                          <th class="cm-mnf-ex-name" md-column md-order-by="importMfgPN">Import {{vm.LabelConstant.MFGPN}}</th>
                          <th class="cm-mnf-ex-name" md-column md-order-by="userName">Imported By</th>
                          <th class="cm-mnf-action" md-column>Delete</th>
                        </tr>
                      </thead>
                      <tbody md-body>
                        <tr md-row ng-repeat="item in vm.apiErrorList | orderBy: vm.errorOrder">
                          <td class="text-left cm-mnf-action icon-square md-cell">
                            <div class="cm-square-icon-btn">
                              <md-button class="md-raised md-icon-button md-accent supplier-error-parts" ng-if="(!item.mfgcodeId) && item.importMfrName" ng-click="vm.addMFG(item, $event)">
                                <md-tooltip md-direction="top">Add As {{vm.LabelConstant.Manufacturer}}</md-tooltip>
                                <md-icon md-font-icon class="icon s18 t-icons-manufacturer add-icon"></md-icon>
                              </md-button>
                              <md-button class="md-raised md-icon-button md-accent supplier-error-parts" ng-if="item.importMfgPN" ng-click="vm.addPart(item, $event)">
                                <md-tooltip md-direction="top">Add As {{vm.LabelConstant.MFGPN}}</md-tooltip>
                                <md-icon md-font-icon class="icon s18 t-icons-add-mfr-pn add-icon"></md-icon>
                              </md-button>
                            </div>
                          </td>
                          <td class="cm-mnf-no"> {{$index + 1}} </td>
                          <td class="cm-mnf-ex-name md-cell">
                            <div layout>
                              {{item.importMfrName}}
                              <span ng-if="(!item.mfgcodeId)">{{item.mfrName}}</span>
                              <span ng-if="item.importMfrName" class="cm-ml-auto"
                                    ng-click="vm.gotoGoogle(item.importMfrName)">
                                <img role="img" class="height-20" ng-src="{{vm.googleImage}}" />
                                <md-tooltip md-direction="top">Search Google</md-tooltip>
                              </span>
                            </div>
                          </td>
                          <td class="cm-mnf-code md-cell">
                            <div layout>
                              <a class="cm-text-decoration" ng-if="item.mfgcodeId" ng-click="vm.goToManufacturer(item.mfgcodeId)">
                                <span>{{item.importMfrName}}</span>
                              </a>
                            </div>
                          </td>
                          <td class="cm-mnf-ex-name md-cell">
                            <div layout>
                              {{item.importMfgPN}}
                              <div class="cm-ml-auto">
                                <span ng-if="item.importMfgPN" class="margin-left-5"
                                      ng-click="vm.gotoSupplier(item.importMfgPN,vm.apiConstant.DIGIKEY,false)">
                                  <img role="img" class="height-22" ng-src="{{vm.apiConstant.DKimage}}" />
                                  <md-tooltip md-direction="top">Search Digikey</md-tooltip>
                                </span>
                                <span ng-if="item.importMfgPN" class="margin-left-5"
                                      ng-click="vm.gotoSupplier(item.importMfgPN,vm.apiConstant.FINDCHIPS,true)">
                                  <img role="img" class="margin-top-3" ng-src="{{vm.apiConstant.FindChipImage}}" />
                                  <md-tooltip md-direction="top">Search FindChip</md-tooltip>
                                </span>
                                <span class="margin-left-5" ng-if="item.importMfgPN"
                                      ng-click="vm.gotoGoogle(item.importMfgPN)">
                                  <img role="img" class="height-20" ng-if="item.importMfgPN" ng-src="{{vm.googleImage}}" />
                                  <md-tooltip md-direction="top">Search Google</md-tooltip>
                                </span>
                              </div>
                            </div>
                          </td>
                          <td class="cm-mnf-ex-name">
                            <div layout>
                              <span>{{item.userName}}</span>
                            </div>
                          </td>
                          <td class="text-left cm-mnf-action icon-square">
                            <md-button class="md-mini md-icon-button margin-0"
                                       ng-click="vm.removeAliasFromList($event, item,false)">
                              <md-icon md-font-icon="icon-trash"></md-icon><md-tooltip>Delete</md-tooltip>
                            </md-button>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </md-table-container>
                  <div class="empty-state full-height-90" layout="row" layout-wrap layout-align="center center"
                       ng-if="(vm.apiErrorList| filter: vm.errorSearch).length == 0 ">
                    <div class="emty-icon" flex="100">
                      <img ng-src="{{vm.empty.IMAGEURL}}" />
                    </div>
                    <p class="empty-state-title" flex="100">{{vm.empty.MESSAGE}}</p>
                  </div>
                </md-card>
              </md-tab-body>
            </md-tab>
            <md-tab md-on-select="vm.onTabChanges(msWizard)">
              <md-tab-label>
                <span class="ms-form-wizard-step-label">
                  <span class="ms-form-wizard-step-text">Mapped List ({{vm.apiVerificationList.length}})</span>
                </span>
              </md-tab-label>
              <md-tab-body>
                <div layout="row" flex="40" flex-lg="50" flex-sm="100">
                  <div class="cm-section-main border-0" layout="row" layout-wrap flex="100">
                    <div class="cm-section-inner" flex="100">
                      <div flex="100" layout="row" class="padding-10 layout-row flex-100 cm-padding-left-5-imp">
                        <div class="input-wrapper">
                          <div layout="row">
                            <p class="label-container">Search</p>
                            <md-radio-group class="margin-left-15" layout="row" ng-model="vm.allMappedMfgsModel.searchType" ng-change="vm.changeSearchType()">
                              <md-radio-button ng-value="vm.CustomSearchTypeForList.Contains" class="md-primary margin-top-0">Contains</md-radio-button>
                              <md-radio-button ng-value="vm.CustomSearchTypeForList.Exact" class="md-primary margin-right-10 margin-top-0">Exact</md-radio-button>
                            </md-radio-group>
                          </div>
                        </div>
                        <div layout="row" flex>
                          <div layout="row" class="input-wrapper" flex>
                            <md-input-container class="margin-top-0 md-block margin-right-10" flex="100" md-no-float>
                              <input type="text" name="search" ng-model="vm.allMappedMfgsModel.searchText"
                                     placeholder="Type here to search" maxlength="100" ng-change="vm.searchMappedList(vm.allMappedMfgsModel.searchText)"
                                     ng-model-options="{debounce: vm.debounceTime }">
                            </md-input-container>
                          </div>
                          <div>
                            <md-button class="md-primary md-raised margin-0 margin-left-5-imp" ng-click="vm.removeVerifyListFilter(true);"
                                       aria-label="Reset">Reset</md-button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <md-card class="margin-0 cm-mfg-grid-title" layout="column" layout-align="space-between stretch" flex="100">
                  <md-table-container flex="100" class="mh-10 mb-10 max-height-300 cm-sticky-header-table">
                    <table md-table class="md-data-table table-row-select">
                      <thead md-head md-order="vm.mappedOrder">
                        <tr md-row>
                          <th class="cm-part-imp-action" md-column>Action</th>
                          <th class="cm-part-imp-no">#</th>
                          <th class="cm-part-imp-mfr" md-column md-order-by="importMfrName">Import {{vm.LabelConstant.MFG}}</th>
                          <th class="cm-part-imp-mpn" md-column md-order-by="importMfgPN">Import {{vm.LabelConstant.MFGPN}}</th>
                          <th class="cm-part-mfr" md-column md-order-by="mfrName">{{vm.LabelConstant.MFG}}</th>
                          <th class="cm-part-mpn" md-column md-order-by="mfgPN">{{vm.LabelConstant.MFGPN}}</th>
                          <th class="cm-part-mfr" md-column md-order-by="supplierName">{{vm.LabelConstant.Supplier}}</th>
                          <th class="cm-part-mpn" md-column md-order-by="spn">{{vm.LabelConstant.SupplierPN}}</th>
                          <th class="cm-part-createdby" md-column md-order-by="createdBy">{{vm.createdbyLabel}}</th>
                          <th class="cm-part-createdat" md-column md-order-by="createdAt">{{vm.createdAtLabel}}</th>
                          <th class="cm-part-createdby" md-column md-order-by="userName">Imported By</th>
                        </tr>
                      </thead>
                      <tbody md-body>
                        <tr md-row ng-repeat="item in vm.apiVerificationList | orderBy: vm.mappedOrder">
                          <td class="text-left cm-part-imp-action md-cell">
                            <i style="vertical-align: middle;" class="icon-check-circle checked font-size-36 green-fg margin-left-5">
                              <md-tooltip md-direction="top">Resolved</md-tooltip>
                            </i>
                          </td>
                          <td class="cm-part-imp-no md-cell"> {{$index + 1}} </td>
                          <td class="cm-part-imp-mfr md-cell">
                            <div layout>
                              {{item.importMfrName}}
                            </div>
                          </td>
                          <td class="cm-part-imp-mpn md-cell">
                            <div layout>
                              {{item.importMfgPN}}
                            </div>
                          </td>
                          <td class="cm-part-mfr md-cell">
                            <div layout>
                              <a class="cm-text-decoration" ng-click="vm.goToManufacturer(item.mfgcodeId)">
                                <span>{{item.mfrName}}</span>
                              </a>
                            </div>
                          </td>
                          <td class="cm-part-mpn md-cell">
                            <div layout>
                              <a class="cm-text-decoration" ng-click="vm.goToComponentDetail(item.componentId, vm.mfgType.MFG)">
                                <span>{{item.mfgPN}}</span>
                              </a>
                            </div>
                          </td>
                          <td class="cm-part-mfr md-cell">
                            <div layout>
                              <span ng-if="(!item.refSupplierMfgpnComponentID)">{{item.supplierName}}</span>
                              <a class="cm-text-decoration" ng-if="item.refSupplierMfgpnComponentID" ng-click="vm.goToSupplierDetail(item.supplierId)">
                                <span>{{item.supplierName}}</span>
                              </a>
                            </div>
                          </td>
                          <td class="cm-part-mpn md-cell">
                            <div layout>
                              <span ng-if="(!item.refSupplierMfgpnComponentID)">{{item.spn}}</span>
                              <a class="cm-text-decoration" ng-if="item.refSupplierMfgpnComponentID" ng-click="vm.goToComponentDetail(item.refSupplierMfgpnComponentID, vm.mfgType.DIST)">
                                <span>{{item.spn}}</span>
                              </a>
                            </div>
                          </td>
                          <td class="cm-part-createdby md-cell">
                            <div layout>
                              <span>{{item.createdBy}}</span>
                            </div>
                          </td>
                          <td class="cm-part-createdat md-cell">
                            <div layout>
                              <span>{{item.createdAt}}</span>
                            </div>
                          </td>
                          <td class="cm-part-createdby md-cell">
                            <div layout>
                              <span>{{item.userName}}</span>
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </md-table-container>
                  <div class="empty-state full-height-90" layout="row" layout-wrap layout-align="center center"
                       ng-if="(vm.apiVerificationList| filter: vm.errorSearch).length == 0 ">
                    <div class="emty-icon" flex="100">
                      <img ng-src="{{vm.empty.IMAGEURL}}" />
                    </div>
                    <p class="empty-state-title" flex="100">{{vm.empty.MESSAGE}}</p>
                  </div>
                </md-card>
              </md-tab-body>
            </md-tab>
          </md-tabs>
        </ms-form-wizard>
      </md-content>
    </md-dialog-content>
    <md-dialog-actions layout="row" layout-wrap layout-align="space-between center">
      <div layout="column" layout-align-sm="start center" class="cm-bom-clean-progress">
        <div layout="row">
          <md-button class="md-raised md-button md-ink-ripple" ng-if="vm.remainTime" ng-click="vm.cancelAPIVerification()" ng-disabled="vm.isBOMReadOnly" layout="row">
            <span md-font-icon="" class="material-icons mat-icon bom-icon-color" flex="100"><span> Stop Verifying PN Externally</span></span>
            <div class="cm-quote-progress" style="width:{{vm.bomCleanProgress+'%'}}"></div>
            <div class="cm-progressbar" layout-align="end end"><md-progress-linear md-mode="indeterminate"></md-progress-linear></div>
            <md-tooltip md-direction="top" class="tt-multiline">{{vm.bomCleanProgress.toFixed(2)}}% PN external verification complete<br />Time Remaining: {{vm.remainTime}}</md-tooltip>
          </md-button>
          <md-button class="md-raised md-primary md-button md-ink-ripple text-white btn-api-int" ng-if="!vm.remainTime && vm.checkContinue() && !vm.issueCount"
                     ng-click="vm.verifyInternally($event)">
            <span>Verify PN Externally</span>
            <span ng-if="vm.issueCount">RESOLVE({{vm.issueCount}}) ERRORS THEN VERIFY PN EXTERNALLY</span>
          </md-button>
          <md-button class="md-raised md-primary md-button md-ink-ripple text-white btn-api-int" ng-if="vm.issueCount" ng-click="vm.apiVerification(true, $event)">
            <span ng-if="vm.issueCount">RESOLVE({{vm.issueCount}}) ERRORS THEN VERIFY PN EXTERNALLY</span>
          </md-button>
        </div>
      </div>
      <div layout="column" flex="nogrow" layout-align-sm="end end" flex-sm="100">
        <div layout="row">
          <md-button class="md-primary md-raised" ng-click="vm.reVerifyMPNImport()">Refresh</md-button>
          <md-button class="md-default md-raised" ng-click="vm.cancel(false)">{{vm.checkContinue()?'Cancel':'Close'}}</md-button>
          <md-button class="md-primary md-raised" ng-click="vm.appendMFRDetail()">Append {{vm.LabelConstant.MFGPN}}</md-button>
          <!--<md-button class="md-primary md-raised" ng-click="vm.cancel(false)">OK</md-button>-->
          <md-button class="md-primary md-raised" ng-click="vm.cancel(true)">Clear List & Import New</md-button>
        </div>
      </div>
    </md-dialog-actions>
  </form>
</md-dialog>
