<div id="contactPerson-list" class="page-layout carded fullwidth breadcrumb-fixed" layout="row" cg-busy="{promise:vm.cgBusyLoading}">
  <div class="top-bg md-accent-bg"></div>
  <div class="center margin-left-0 margin-right-0" layout="column" flex>
    <div class="header" layout="row" layout-align="space-between center">
      <div class="white-fg" layout="column" layout-align="start start">
        <div class="h2" layout="row" layout-align="start center">
          <pagetitle is-list="true" is-display-menu-name="true"></pagetitle>
        </div>
        <div layout="row" layout-align="start center">
          <breadcrumbs></breadcrumbs>
        </div>
      </div>
      <div>
        <md-button class="md-raised md-primary md-icon-button cm-width-40-rs" ng-click="vm.showColorLengend($event)">
          <md-icon md-font-icon class="icon-palette"></md-icon>
          <md-tooltip md-direction="top">Phone Type Legend</md-tooltip>
        </md-button>
        <md-button class="md-primary md-raised" ng-click="vm.updateRecord(null,$event)">
          Add {{vm.currentPageName }}
        </md-button>
      </div>
    </div>
    <div class="content-card padding-top-side contactperson-grid" layout="column" flex ng-show="!vm.isNoDataFound">
      <div layout="row">
        <form class="md-inline-form cm-custom-label-common width-100p pt-10 cm-so-list-filters advanced-filters" name="vm.filtersInfo">
          <div flex="100" class="umid-advance-filter advanced-filters" layout-wrap>
            <div layout="row" flex="100" class="overflow-auto-rs padding-left-8">
              <div layout="column" class="padding-right-5" flex="20">
                <div layout="column" class="alias-list-main cm-alias-list-main-static-block" flex>
                  <div class="title alias-list-title cm-alias-list-title-static-block" layout="row" flex="100" layout-align="space-between center">
                    <span class="label-container width-auto">
                      Supplier/Customer/Manufacturer
                    </span>
                    <div layout="row" layout-align="center center" flex="100" class="cm-part-mfr-list-search">
                      <md-input-container md-no-float flex="100" layout="row" class="margin-0 pos-rel">
                        <input type="text" name="CustomerSearchText" id="CustomerSearchText" ng-model="vm.filter.CustomerSearchText"
                               placeholder="Type here to search"
                               ng-maxlength="50" autocomplete="off"
                               ng-model-options="{ debounce: vm.configTimeout }"
                               ng-change="vm.searchCustomerList()">
                        <md-button ng-if="vm.filter.CustomerSearchText" class="md-icon-button height-20 width-20 line-height-20 cm-part-filter-clear-btn margin-top-3 padding-0"
                                   ng-click="vm.clearCustomerSearchText()">
                          <md-icon role="img" md-font-icon="icon-close" class="material-icons mat-icon icon-close font-size-12 color-white"></md-icon>
                        </md-button>
                      </md-input-container>
                    </div>
                    <div layout="row" layout-align="center center">
                      <a class="cm-text-decoration underline"
                         ng-click="vm.clearCustomerFilter();"
                         tabindex="-1"
                         ng-if="vm.filter.mfgIds.length">
                        Clear
                      </a>
                      <md-button ng-click="vm.getCustomerList();" class="md-primary md-link-ripple cm-part-advance-filter-btn">
                        <md-icon md-font-icon="icon-reload">
                          <md-tooltip>Reload</md-tooltip>
                        </md-icon>
                      </md-button>
                    </div>
                  </div>
                  <select ng-model="vm.filter.mfgIds" size="10" multiple="" class="cm-auto-scroll" ng-if="vm.customerListToDisplay && vm.customerListToDisplay.length">
                    <option ng-repeat="x in vm.customerListToDisplay" value="{{x.id}}">{{x.mfgCodeName}}</option>
                  </select>
                  <div class="empty-state text-center full-height" flex="100" layout="row" layout-align="center center" layout-wrap
                       ng-if="(!vm.customerListToDisplay || vm.customerListToDisplay.length === 0) && vm.filter.CustomerSearchText">
                    <p flex="100" class="empty-state-title font-size-17-imp">{{vm.EmptyMesssages.MESSAGE}}</p>
                  </div>
                </div>
              </div>
              <div layout="column" class="padding-right-5" flex="15">
                <div layout="column" class="alias-list-main cm-alias-list-main-static-block" flex>
                  <div class="title alias-list-title cm-alias-list-title-static-block" layout="row" flex="100" layout-align="space-between center">
                    <span class="label-container width-auto">
                      Assigned Personnel
                    </span>
                    <div layout="row" layout-align="center center" flex="100" class="cm-part-mfr-list-search">
                      <md-input-container md-no-float flex="100" layout="row" class="margin-0 pos-rel">
                        <input type="text" name="CustomerSearchText" id="CustomerSearchText" ng-model="vm.filter.personnelSearchText"
                               placeholder="Type here to search"
                               ng-maxlength="50" autocomplete="off"
                               ng-model-options="{ debounce: vm.configTimeout }"
                               ng-change="vm.searchPersonnelList()">
                        <md-button ng-if="vm.filter.personnelSearchText" class="md-icon-button height-20 width-20 line-height-20 cm-part-filter-clear-btn margin-top-3 padding-0"
                                   ng-click="vm.clearPersonnelSearchText()">
                          <md-icon role="img" md-font-icon="icon-close" class="material-icons mat-icon icon-close font-size-12 color-white"></md-icon>
                        </md-button>
                      </md-input-container>
                    </div>
                    <div layout="row" layout-align="center center">
                      <a class="cm-text-decoration underline"
                         ng-click="vm.clearPersonnelFilter();"
                         tabindex="-1"
                         ng-if="vm.filter.empIds.length">
                        Clear
                      </a>
                      <md-button ng-click="vm.getPersonnelList();" class="md-primary md-link-ripple cm-part-advance-filter-btn">
                        <md-icon md-font-icon="icon-reload">
                          <md-tooltip>Reload</md-tooltip>
                        </md-icon>
                      </md-button>
                    </div>
                  </div>
                  <select ng-model="vm.filter.empIds" size="10" multiple="" class="cm-auto-scroll" ng-if="vm.personnelListToDisplay && vm.personnelListToDisplay.length">
                    <option ng-repeat="x in vm.personnelListToDisplay" value="{{x.id}}">{{x.formattedEmpName}}</option>
                  </select>
                  <div class="empty-state text-center full-height" flex="100" layout="row" layout-align="center center" layout-wrap
                       ng-if="(!vm.personnelListToDisplay || vm.personnelListToDisplay.length === 0) && vm.filter.personnelSearchText">
                    <p flex="100" class="empty-state-title font-size-17-imp">{{vm.EmptyMesssages.MESSAGE}}</p>
                  </div>
                </div>
              </div>
              <div layout="column" class="input-wrapper pr-5">
                <fieldset flex="100" class="container-box">
                  <legend class="margin-0">Contact Person Type</legend>
                  <div layout="row" flex="100">
                    <md-input-container flex="100">
                      <md-radio-group class="margin-0" layout="column"
                                      name="refEntityType" ng-model="vm.filter.refEntityType">
                        <md-radio-button class="margin-top-0" ng-repeat="item in vm.RefEntityTypeRadio" ng-value="item.Value">{{item.GridDisplayValue}}</md-radio-button>
                      </md-radio-group>
                    </md-input-container>
                  </div>
                </fieldset>
              </div>
              <div layout="row">
                <div class="input-wrapper pr-5 mt-8" layout="column" flex flex-md="100" flex-sm="100">
                  <div flex layout="column">
                    <div layout="row" layout-md="column" layout-sm="column" class="cm-section-main">
                      <md-input-container class="margin-bottom-0" flex md-no-float>
                        <md-checkbox ng-model="vm.filter.isPrimary" name="isPrimary">
                          Primary Person
                        </md-checkbox>
                      </md-input-container>
                    </div>
                    <div layout="row" flex layout-md="column" layout-sm="column" class="mt-5  cm-section-main">
                      <md-input-container class="margin-bottom-0" flex md-no-float>
                        <md-checkbox ng-model="vm.filter.isDefault" name="isDefault">
                          Default "Attention To"
                        </md-checkbox>
                      </md-input-container>
                    </div>
                  </div>
                </div>
              </div>
              <div flex layout="column">
                <div layout="row" flex>
                  <div class="input-wrapper pr-5" layout="column" flex flex-md="100" flex-sm="100">
                    <fieldset flex="100" class="container-box">
                      <legend class="margin-0">Search Comment</legend>
                      <div layout="row" flex="100" layout-align="start center" layout-md="column" layout-sm="column">
                        <md-input-container class="margin-bottom-0" flex md-no-float>
                          <input type="text" id="additionalComment" name="additionalComment"
                                 ng-model="vm.filter.additionalComment" placeholder="Search Comment"
                                 ng-maxlength="1000" ng-keypress="vm.applyFiltersOnEnter($event)"
                                 autocomplete="off" />
                          <md-button ng-if="vm.filter.additionalComment" class="md-icon-button bg-white height-auto width-auto border-radius-2 cm-part-filter-clear-btn margin-top-1 padding-0"
                                     ng-click="vm.filter.additionalComment=null;">
                            <md-icon role="img" md-font-icon="icon-close" class="material-icons mat-icon s20 icon-close"></md-icon>
                          </md-button>
                          <div ng-messages="vm.filtersInfo.additionalComment.$error" role="alert">
                            <div ng-message="maxlength">
                              <span>{{vm.getMaxLengthValidation(1000,vm.filtersInfo.additionalComment.$viewValue.length)}}</span>
                            </div>
                          </div>
                        </md-input-container>
                      </div>
                    </fieldset>
                  </div>
                </div>
                <div layout="row" flex>
                  <div class="input-wrapper pr-5" layout="column" flex flex-md="100" flex-sm="100">
                    <fieldset flex="100" class="container-box">
                      <legend class="margin-0">Search First Name / Middle Name /Last Name</legend>
                      <div layout="row" flex="100" layout-md="column" layout-sm="column">
                        <div layout="row" layout-align="start center">
                          <md-radio-group class=" mb-5" flex="100" layout="row" ng-model="vm.filter.checkNameType" name="checkSerachNameType">
                            <md-radio-button ng-value="vm.CheckSearchTypeList[1].id" class="md-primary margin-top-0">Contains</md-radio-button>
                            <md-radio-button ng-value="vm.CheckSearchTypeList[0].id" class="md-primary margin-top-0">Exact</md-radio-button>
                          </md-radio-group>
                        </div>
                        <div layout="row" flex="100" layout-align="start center">
                          <md-input-container flex="100" class="margin-bottom-0">
                            <input type="text" id="nameSearch" name="nameSearch" ng-model="vm.filter.nameSearch"
                                   ng-maxlength="255" ng-keypress="vm.applyFiltersOnEnter($event)"
                                   placeholder="Search First Name / Middle Name /Last Name" />
                            <md-button ng-if="vm.filter.nameSearch" class="md-icon-button bg-white height-auto width-auto border-radius-2 cm-part-filter-clear-btn margin-top-1 padding-0"
                                       ng-click="vm.filter.nameSearch=null;">
                              <md-icon role="img" md-font-icon="icon-close" class="material-icons mat-icon s20 icon-close"></md-icon>
                            </md-button>
                            <div ng-messages="vm.filtersInfo.nameSearch.$error" role="alert">
                              <div ng-message="maxlength">
                                <span>{{vm.getMaxLengthValidation(1000,vm.filtersInfo.nameSearch.$viewValue.length)}}</span>
                              </div>
                            </div>
                          </md-input-container>
                        </div>
                      </div>
                    </fieldset>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="mb-5 mt-5 input-wrapper" layout="row" layout-align="end-end" flex="100">
            <div>
              <md-button class="md-primary md-raised md-ink-ripple mv-0" ng-click="vm.applyFilters()">{{vm.LabelConstant.COMMON.APPLY_FILTERS}}</md-button>
              <button class="md-default md-raised md-button md-default-theme md-ink-ripple mv-0" type="button" ng-click="vm.clearSelection()" ng-disabled="!vm.generateFilter">
                {{vm.LabelConstant.COMMON.CLEAR_ALL}}
              </button>
              <md-button class="md-primary md-raised md-ink-ripple mv-0" ng-click="vm.resetAllFilter()">{{vm.LabelConstant.COMMON.RESET}}</md-button>
            </div>
          </div>
          <div layout="row" layout-align="start center" layout-wrap flex="100" class="padding-left-10 mb-5" ng-if="vm.generateFilter">
            <span class="font-weight-600">
              {{vm.LabelConstant.COMMON.APPLIED_FILTERS}}
            </span>
            <div ng-repeat="item in vm.ContactPersonAdvanceFilter" layout="row" layout-align="start center" class="cm-tracking-chip-mian"
                 ng-if="!item.isDeleted">
              <div class="tracking-number-chip" layout="row" layout-align="start center">
                <label>
                  {{item.value}}
                  <md-tooltip md-direction="top" ng-if="item.tooltip" class="tooltip-height-auto"
                              ng-bind-html="item.tooltip">
                  </md-tooltip>
                </label>
                <md-button class="md-icon-button md-primary md-mini" ng-click="vm.removeAppliedFilter(item, $index)">
                  <md-icon md-font-icon="icon-close" class="material-icons mat-icon"></md-icon>
                  <md-tooltip>Click to remove this filter</md-tooltip>
                </md-button>
              </div>
            </div>
          </div>
          <div layout="row" layout-align="start center" layout-wrap flex="100" class="padding-left-10 mb-5"
               ng-if="vm.isUiGridColumnFiltersApplied && vm.gridOptions.gridApi && vm.gridOptions.gridApi.grid.columns.length > 0">
            <span class="font-weight-600">
              {{vm.LabelConstant.COMMON.APPLIED_GRID_FILTERS}}
            </span>
            <div ng-repeat="item in vm.gridOptions.gridApi.grid.columns" layout="row" layout-align="start center" class="cm-tracking-chip-mian"
                 ng-if="item.filters[0].term">
              <div class="tracking-number-chip" layout="row" layout-align="start center" ng-if="item.filters[0].term">
                <label>
                  {{item.displayName}}
                  <md-tooltip md-direction="top" ng-if="item.filters[0].term" class="tooltip-height-auto"
                              ng-bind-html="item.filters[0].term">
                  </md-tooltip>
                </label>
                <md-button class="md-icon-button md-primary md-mini" ng-click="vm.clearGridColumnFilter(item, $index)">
                  <md-icon md-font-icon="icon-close" class="material-icons mat-icon"></md-icon>
                  <md-tooltip>Click to remove this filter</md-tooltip>
                </md-button>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div layout="column" flex>
        <md-card layout="column" flex layout-align="space-between stretch">
          <!--class="employee-master-grid"-->
          <ui-grid-extention layout="column" flex
                             load-data="vm.loadData"
                             grid-id="vm.gridConfig.gridContactPersonList"
                             grid-option="vm.gridOptions"
                             header="vm.sourceHeader"
                             grid-data="vm.sourceData"
                             total-data-count="vm.totalSourceDataCount"
                             reset-grid="vm.resetSourceGrid"
                             selectted-rows="vm.selectedRowsList"
                             paging-info="vm.pagingInfo"
                             current-item="vm.currentdata"
                             get-data-down="vm.getDataDown"
                             empty-state="vm.emptyState"
                             delete-multiple-data="vm.deleteMultipleData">
        </md-card>
      </div>
    </div>
    <div class="empty-state text-center full-height" layout="row" layout-align="center center" layout-wrap ng-if="vm.isNoDataFound">
      <div class="emty-icon" flex="100">
        <md-icon role="img" md-font-icon="icon {{vm.EmptyMesssage.ICON_CLASS}}" class="s150 md-accent-fg"></md-icon>
      </div>
      <p flex="100" class="empty-state-title">{{vm.EmptyMesssage.MESSAGE}}</p>
      <p flex="100">
        {{vm.EmptyMesssage.ADDNEWMESSAGE}}
      </p>
      <p flex="100">
        <md-button class="md-fab md-mini" ng-click="vm.updateRecord(null,$event)">
          <md-icon role="img" md-font-icon="icon-plus" class="material-icons mat-icon icon-plus">
            <md-tooltip>Add {{vm.currentPageName}}</md-tooltip>
          </md-icon>
        </md-button>
        <md-button class="md-fab md-mini" aria-label="Refresh Contact Person" ng-click="vm.loadData()">
          <md-icon role="img" md-font-icon="icon-refresh" class="material-icons mat-icon icon-plus">
            <md-tooltip>Refresh {{vm.currentPageName}}</md-tooltip>
          </md-icon>
        </md-button>
      </p>
    </div>
  </div>
</div>


<style>
  .contactperson-grid .ui-grid-row {
    height: auto !important;
  }

  .contactperson-grid .ui-grid-cell {
    display: table-cell;
    float: none;
    vertical-align: middle;
    height: auto !important;
  }
</style>
