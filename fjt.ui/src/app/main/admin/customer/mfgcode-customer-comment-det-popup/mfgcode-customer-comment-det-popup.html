<md-dialog aria-label="CustomerCommentDetail" class="cm-custom-label-common max-height-80p" cg-busy="{promise:vm.cgBusyLoading}" draggable flex="60">

  <form name="vm.formCustomerCommentDetail" class="md-inline-form">
    <md-button id="btnRequireColValidation" type="submit" ng-hide="true"></md-button>

    <md-toolbar>
      <div class="md-toolbar-tools">
        <h2>Add Comment</h2>
        <span flex></span>
        <popup-header-label label-data="vm.headerdata"></popup-header-label>
        <md-button class="md-icon-button" ng-click="vm.cancel()">
          <md-icon role="img" md-font-icon="icon-close" class="material-icons mat-icon icon-close"></md-icon>
        </md-button>
      </div>
    </md-toolbar>

    <md-dialog-content class="padding-10">
      <md-content class="layout-column">

        <div class="cm-section-main margin-bottom-5">
          <div class="cm-section-inner">

            <table cellspacing="0" cellpadding="0" class="cm-table-input-main">
              <tbody>
                <tr>
                  <th>
                    <p class="label-container">
                      <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToTemplatePurchaseInspectionRequirement()">{{vm.autoCompleteTemplate.placeholderName}}</a>
                    </p>
                  </th>
                  <td>
                    <md-input-container ng-if="vm.autoCompleteTemplate" class="autocompletecustom margin-bottom-0" flex="100">
                      <custom-auto-complete-search class="min-width-initial"
                                                   on-search-fn="vm.autoCompleteTemplate.onSearchFn"
                                                   column-name="vm.autoCompleteTemplate.columnName"
                                                   controller-name="vm.autoCompleteTemplate.controllerName"
                                                   view-template-url="vm.autoCompleteTemplate.viewTemplateURL"
                                                   key-column-name="vm.autoCompleteTemplate.keyColumnName"
                                                   input-name="vm.autoCompleteTemplate.inputName"
                                                   placeholder-name="vm.autoCompleteTemplate.placeholderName"
                                                   key-column-id="vm.autoCompleteTemplate.keyColumnId"
                                                   is-required="vm.autoCompleteTemplate.isRequired"
                                                   parent-column-name="vm.autoCompleteTemplate.parentColumnName"
                                                   is-addnew="vm.autoCompleteTemplate.isAddnew"
                                                   add-data="vm.autoCompleteTemplate.addData"
                                                   callback-fn="vm.autoCompleteTemplate.callbackFn"
                                                   on-select-callback-fn="vm.autoCompleteTemplate.onSelectCallbackFn">
                      </custom-auto-complete-search>
                    </md-input-container>
                  </td>
                </tr>
                <tr ng-if="vm.autoCompletePartRequirementCategory">
                  <th>
                    <p class="label-container">
                      <a class="cm-text-decoration underline" ng-click="vm.goToGenericCategoryPartRequirementCategoryList();" tabindex="-1">{{vm.autoCompletePartRequirementCategory.placeholderName}}</a>
                    </p>
                  </th>
                  <td>
                    <md-input-container class="autocompletecustom margin-bottom-0" flex="100">
                      <custom-auto-complete-search class="min-width-initial"
                                                   on-search-fn="vm.autoCompletePartRequirementCategory.onSearchFn"
                                                   column-name="vm.autoCompletePartRequirementCategory.columnName"
                                                   controller-name="vm.autoCompletePartRequirementCategory.controllerName"
                                                   view-template-url="vm.autoCompletePartRequirementCategory.viewTemplateURL"
                                                   key-column-name="vm.autoCompletePartRequirementCategory.keyColumnName"
                                                   input-name="vm.autoCompletePartRequirementCategory.inputName"
                                                   placeholder-name="vm.autoCompletePartRequirementCategory.placeholderName"
                                                   key-column-id="vm.autoCompletePartRequirementCategory.keyColumnId"
                                                   is-required="vm.autoCompletePartRequirementCategory.isRequired"
                                                   parent-column-name="vm.autoCompletePartRequirementCategory.parentColumnName"
                                                   is-addnew="vm.autoCompletePartRequirementCategory.isAddnew"
                                                   add-data="vm.autoCompletePartRequirementCategory.addData"
                                                   callback-fn="vm.autoCompletePartRequirementCategory.callbackFn"
                                                   on-select-callback-fn="vm.autoCompletePartRequirementCategory.onSelectCallbackFn">
                      </custom-auto-complete-search>
                    </md-input-container>
                  </td>
                </tr>
                <tr>
                  <th>
                    <p class="label-container">
                      <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToPurchaseInspectionRequirement()">{{vm.autoCompletePurchaseRequirement.placeholderName}}</a>
                    </p>
                  </th>
                  <td>
                    <md-input-container ng-if="vm.autoCompletePurchaseRequirement" class="autocompletecustom margin-bottom-0" flex="100" data-focusButton="savePurchaseInspectionDetailBtn" elementcondition="true">
                      <custom-auto-complete-search class="min-width-initial" custom-auto-focus="{{vm.focusOnRequirement}}"
                                                   on-search-fn="vm.autoCompletePurchaseRequirement.onSearchFn"
                                                   column-name="vm.autoCompletePurchaseRequirement.columnName"
                                                   controller-name="vm.autoCompletePurchaseRequirement.controllerName"
                                                   view-template-url="vm.autoCompletePurchaseRequirement.viewTemplateURL"
                                                   key-column-name="vm.autoCompletePurchaseRequirement.keyColumnName"
                                                   input-name="vm.autoCompletePurchaseRequirement.inputName"
                                                   placeholder-name="vm.autoCompletePurchaseRequirement.placeholderName"
                                                   key-column-id="vm.autoCompletePurchaseRequirement.keyColumnId"
                                                   is-required="vm.autoCompletePurchaseRequirement.isRequired"
                                                   parent-column-name="vm.autoCompletePurchaseRequirement.parentColumnName"
                                                   is-addnew="vm.autoCompletePurchaseRequirement.isAddnew"
                                                   add-data="vm.autoCompletePurchaseRequirement.addData"
                                                   callback-fn="vm.autoCompletePurchaseRequirement.callbackFn"
                                                   on-select-callback-fn="vm.autoCompletePurchaseRequirement.onSelectCallbackFn">
                      </custom-auto-complete-search>
                    </md-input-container>
                  </td>
                </tr>

              </tbody>
            </table>

          </div>
        </div>
        <div class="content fullpage-datatable cm-customer-comment-table" layout="column" flex="100" ng-show="vm.customerCommentList && vm.customerCommentList.length > 0">

          <!--Search Box-->
          <div class="mobilesearch title alias-list-title userpermissionhead" layout="row" flex="100" layout-align="space-between center">
            <md-input-container class="md-block error-none no-label" md-no-float flex flex-xs="75">
              <input type="text" name="search" class="font-weight-400" placeholder="Type here to search category /comment" ng-model="vm.searchstring" ng-model-options="{debounce: vm.debounceTime }">
            </md-input-container>
            <md-button class="md-raised md-primary md-ink-ripple margin-0" ng-disabled="!vm.searchstring" ng-click="vm.searchstring=null">
              Clear
            </md-button>
          </div>

          <md-table-container class="cm-customer-comment-grid-scroll" layout="row" flex="100">
            <div class="max-height-300 cm-sticky-header-table flex cm-table-header-blue">
              <table md-table>

                <thead md-head md-order="vm.query.order">
                  <tr md-row>
                    <th md-column class="text-center width-50 cm-blue-header-check-box">
                      <md-tooltip>Select All</md-tooltip>
                      <md-checkbox ng-model="vm.isAllSelect" ng-change="vm.selectAllRequirement()" ng-disabled="(vm.customerCommentList && vm.customerCommentList.length == 0)"></md-checkbox>
                    </th>
                    <th md-column><span class="color-white">#</span></th>
                    <th md-column md-order-by="requiementType" class="w-140"><span class="color-white">Type</span></th>
                    <th md-column  class="w-140">
                      <a class="color-white" ng-click="vm.goToGenericCategoryPartRequirementCategoryList()" tabindex="-1">{{vm.LabelConstant.MFGCODE_COMMENT.PartRequirementCategory}}</a>
                    </th>
                    <th md-column md-order-by="requirement">
                      <a class="color-white" ng-click="vm.goToPurchaseInspectionRequirement()" tabindex="-1">{{vm.LabelConstant.MFGCODE_COMMENT.PurchaseRequirement}}</a>
                    </th>
                  </tr>
                </thead>
                <tbody md-body>

                  <tr md-row md-auto-select ng-repeat="item in vm.customerCommentList | filter:vm.search | orderBy: vm.query.order">
                    <td md-cell class="text-center width-50 height-35">
                      <md-checkbox ng-model="item.isSelect" ng-disabled="item.isDisable" ng-change="vm.selectRequirement(item)" class="margin-top-10 margin-bottom-10"></md-checkbox>
                    </td>
                    <td md-cell >{{$index+1}}</td>
                    <td md-cell ><span class="label-box" ng-class="{'label-success':item.requiementType === vm.RequirementType[0].value, 'label-warning':item.requiementType === vm.RequirementType[1].value }">{{item.requiementType}}</span></td>
                    <td md-cell><a class="cm-text-decoration underline" ng-click="vm.goToManageGenericCategoryPartRequirementCategory(item.requirementCategoryId)">{{item.requirementCategory}}</a></td>
                    <td md-cell>{{item.requirement}}</td>
                  </tr>

                </tbody>
              </table>
            </div>
          </md-table-container>
        </div>
        <div  layout="column" flex="100" ng-show="vm.onSearchingList && vm.customerCommentList && vm.customerCommentList.length == 0">
          <div class="cm-section-main min-height-100 text-center" layout="row" flex="100" layout-align="center center">
            <span class="">No Comments Found</span>
          </div>
        </div>

      </md-content>
    </md-dialog-content>

    <md-dialog-actions layout="row">
      <md-button class="md-default md-raised" ng-click="vm.cancel()">Cancel</md-button>
      <md-button class="md-primary md-raised" ng-click="vm.askConfirmationForSaveOption()" aria-label="Submit" id="savePurchaseInspectionDetailBtn"
                 ng-class="{'md-formdirty': vm.formCustomerCommentDetail.$dirty }"
                 ng-disabled="vm.saveBtnDisableFlag">Save</md-button>
    </md-dialog-actions>

  </form>
</md-dialog>
