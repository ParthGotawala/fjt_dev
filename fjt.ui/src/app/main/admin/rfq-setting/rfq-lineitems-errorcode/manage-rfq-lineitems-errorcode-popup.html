<md-dialog aria-label="Errorcode" flex="80" class="cm-rfq-error-code-popup cm-custom-label-common height-90p" cg-busy="{promise:vm.cgBusyLoading}" draggable>
    <form name="vm.ErrorcodeForm" class="md-inline-form" novalidate>
        <md-button id="btnRequireColValidation" type="submit" ng-hide="true"></md-button>
        <md-toolbar>
          <div class="md-toolbar-tools" layout="row" layout-align="space-between center">
            <h2>{{vm.errorCodeModel.id == null ? 'Add':'Update'}} BOM Error Code</h2>
            <span flex></span>
            <span class="lableheader cm-header-label ng-scope layout-align-start-center layout-row" ng-show="vm.errorCodeModel.isAssemblyLevelError" layout="row" layout-align="start center">
              Assembly Level Issue
            </span>
            <span class="lableheader cm-header-label ng-scope layout-align-start-center layout-row" ng-show="vm.errorCodeModel.isAllowToEngrApproved == 1" layout="row" layout-align="start center">
              Allow Part to Engr. Approved
            </span>
            <div layout-align="center center" class="cm-btn-group cm-square-icon-btn">
              <md-button class="md-icon-button md-primary md-raised md-mini" ng-click="vm.openErrorCodeHistoryPopup($event)" ng-if="vm.errorCodeModel.id">
                <md-icon md-font-icon="t-icons-history-text" class="material-icons"></md-icon>
                <md-tooltip>{{vm.historyactionButtonName}}</md-tooltip>
              </md-button>
              <md-button class="md-icon-button" ng-click="vm.cancel()">
                <md-icon role="img" md-font-icon="icon-close" class="material-icons mat-icon icon-close"></md-icon>
              </md-button>
            </div>
          </div>
        </md-toolbar>
        <md-dialog-content class="customer-modal no-padding">
            <md-content class="padding-10 mh-5">
                <div class="cm-section-main border-0" flex="100">
                    <div class="cm-section-inner">
                        <table cellpadding="0" cellspacing="0" class="cm-table-input-main">
                            <tbody>
                                <tr class="font-size-14" ng-if="vm.errorCodeModel.org_description">
                                    <th class="width-150">
                                        <p class="label-container cm-default-des">Default Description<span>&nbsp;</span></p>
                                    </th>
                                    <td>
                                        <span class="cm-default-des-details">
                                            <span class="md-accent-fg text-bold" id="defaultMessage">{{vm.errorCodeModel.org_description}}</span>
                                            <md-button class="md-icon-button toolbar-button margin-0 height-30 width-20" ng-click="vm.copyTextToClipBoard($event)"
                                                       ng-if="vm.errorCodeModel.org_description">
                                                <md-icon md-font-icon="icon-content-copy" role="img"></md-icon>
                                                <md-tooltip>Copy default description</md-tooltip>
                                            </md-button>
                                            <!--<span class="md-accent-fg text-bold" id="defaultMessage">{{vm.errorCodeModel.org_description}}</span>-->
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <th class="width-150">
                                        <p class="label-container text-bold">Description<span>&nbsp;*</span></p>
                                    </th>
                                    <td>
                                      <md-input-container class="md-block margin-top-15 margin-bottom-0" flex="100">
                                        <textarea type="text" name="description" ng-model="vm.errorCodeModel.description"
                                                  placeholder="Description"  max-rows="4"
                                                  ng-maxlength="vm.descriptionMaxLength"
                                                  md-maxlength="vm.descriptionMaxLength" required></textarea>
                                        <div ng-messages="vm.ErrorcodeForm.description.$error"
                                             role="alert">
                                          <div ng-message="required">
                                            <span>{{vm.CORE_MESSAGE_CONSTANT.REQUIRED}}</span>
                                          </div>
                                          <div ng-message="maxlength">
                                            <span>{{vm.getMaxLengthValidation(vm.descriptionMaxLength, vm.ErrorcodeForm.description.$viewValue.length)}}</span>
                                          </div>
                                        </div>
                                      </md-input-container>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!--<div layout="row" class="font-size-14 input-wrapper" layout-align="start center" ng-if="vm.errorCodeModel.org_description">
                  <p class="label-container text-bold" flex="10" flex-sm="25">Default Description</p>
                  <span>
                    <md-button class="md-icon-button toolbar-button margin-0" ng-click="vm.copyTextToClipBoard($event)"
                               ng-if="vm.errorCodeModel.org_description">
                      <md-icon md-font-icon="icon-content-copy" role="img"></md-icon>
                      <md-tooltip>Copy default description</md-tooltip>
                    </md-button>
                    <span class="md-accent-fg text-bold" id="defaultMessage">{{vm.errorCodeModel.org_description}}</span>
                  </span>
                </div>
                <div layout="row" flex="100" class="input-wrapper">
                  <p class="label-container" flex="10">Description<span>&nbsp;*</span></p>
                  <md-input-container class="md-block margin-top-15 margin-bottom-0" flex="100">
                    <input type="text" textatcaret="" name="description" placeholder="Description" ng-maxlength="255" ng-model="vm.errorCodeModel.description" required />
                    <div ng-messages="vm.ErrorcodeForm.description.$error"
                         role="alert">
                      <div ng-message="required">
                        <span>{{vm.CORE_MESSAGE_CONSTANT.REQUIRED}}</span>
                      </div>
                      <div ng-message="maxlength">
                        <span>{{vm.getMaxLengthValidation(255, vm.ErrorcodeForm.description.$viewValue.length)}}</span>
                      </div>
                    </div>
                  </md-input-container>
                </div>-->
                <div layout="row" flex="100">
                    <div flex="70" flex-md="50" flex-lg="50" flex-gt-lg="70">
                        <div class="cm-section-main border-0" flex="100">
                            <div class="cm-section-inner">
                                <table cellpadding="0" cellspacing="0" class="cm-table-input-main">
                                  <tbody>
                                    <tr>
                                      <th class="width-150">
                                        <p class="label-container">Logic Category<span>&nbsp;</span></p>
                                      </th>
                                      <td colspan="5">
                                        <md-input-container class="md-block autocompletecustom" ng-if="vm.autoCompleteCategory" flex="100" flex-xs="100" custom-auto-focus="true">
                                          <custom-auto-complete datalist="vm.logicCategoryList"
                                                                column-name="vm.autoCompleteCategory.columnName"
                                                                key-column-name="vm.autoCompleteCategory.keyColumnName"
                                                                input-name="vm.autoCompleteCategory.inputName"
                                                                placeholder-name="vm.autoCompleteCategory.placeholderName"
                                                                key-column-id="vm.autoCompleteCategory.keyColumnId"
                                                                is-required="vm.autoCompleteCategory.isRequired"
                                                                is-disabled="vm.autoCompleteCategory.isDisabled">
                                          </custom-auto-complete>
                                        </md-input-container>
                                      </td>
                                    </tr>
                                    <tr>
                                      <th class="width-150">
                                        <p class="label-container">Error Code<span>&nbsp;</span></p>
                                      </th>
                                      <td colspan="5">
                                        <md-input-container class="md-block" ng-class="vm.themeClass" flex="100">
                                          <input type="text" name="errorCode" ng-model="vm.errorCodeModel.errorCode"
                                                 placeholder="Error Code" ng-maxlength="255"  md-maxlength="255"disabled>
                                          <div ng-messages="vm.ErrorcodeForm.errorCode.$error"
                                               role="alert">
                                            <div ng-message="required">
                                              <span>{{vm.CORE_MESSAGE_CONSTANT.REQUIRED}}</span>
                                            </div>
                                            <div ng-message="maxlength">
                                              <span>{{vm.getMaxLengthValidation(255, vm.ErrorcodeForm.errorCode.$viewValue.length)}}</span>
                                            </div>
                                          </div>
                                        </md-input-container>
                                      </td>
                                    </tr>
                                    <tr>
                                      <th class="width-150">
                                        <p class="label-container">Display Name<span>&nbsp;*</span></p>
                                      </th>
                                      <td colspan="5">
                                        <md-input-container class="md-block" ng-class="vm.themeClass" flex="100">
                                          <input type="text" name="displayName" ng-model="vm.errorCodeModel.displayName"
                                                 placeholder="Display Name" required ng-maxlength="100" md-maxlength="100">
                                          <div ng-messages="vm.ErrorcodeForm.displayName.$error"
                                               role="alert">
                                            <div ng-message="required">
                                              <span>{{vm.CORE_MESSAGE_CONSTANT.REQUIRED}}</span>
                                            </div>
                                            <div ng-message="maxlength">
                                              <span>{{vm.getMaxLengthValidation(100, vm.ErrorcodeForm.displayName.$viewValue.length)}}</span>
                                            </div>
                                          </div>
                                        </md-input-container>
                                      </td>
                                    </tr>
                                    <tr>
                                      <th class="width-150">
                                      </th>
                                      <td layout="row">
                                        <md-checkbox ng-model="vm.errorCodeModel.isExternalIssue" name="isExternalIssue" class="margin-4">
                                          Is External Issue
                                        </md-checkbox>
                                        <div class="icon-question-mark-circle help-icon margin-top-6">
                                          <md-tooltip md-direction="top" class="tooltip-height-auto"
                                                      ng-bind-html="vm.CORE_MESSAGE_CONSTANT.ERROR_EXTERNAL_ISSUE_TOOLTIP_MESSAGE">
                                          </md-tooltip>
                                        </div>
                                      </td>
                                      <th>
                                      </th>
                                      <td layout="row">
                                        <md-checkbox ng-model="vm.errorCodeModel.isResearchStatus" name="isResearchStatus" class="margin-4">
                                          Is Include In R&D Activity
                                        </md-checkbox>
                                        <div class="icon-question-mark-circle help-icon margin-top-6">
                                          <md-tooltip md-direction="top" class="tooltip-height-auto"
                                                      ng-bind-html="vm.CORE_MESSAGE_CONSTANT.ERROR_RD_ACTIVITY_TOOLTIP_MESSAGE">
                                          </md-tooltip>
                                        </div>
                                      </td>
                                    </tr>
                                    <!--<tr>
                                      <th class="width-170">
                                        <p class="label-container">Allow Part to Engr. Approved<span>&nbsp;</span></p>
                                      </th>
                                      <td colspan="5">
                                          <md-input-container flex="100">
                                            <md-radio-group layout-align="start"
                                                            name="customprice" ng-model="vm.errorCodeModel.isAllowToEngrApproved" flex="100" >
                                              <md-radio-button flex class="margin-top-0 margin-right-0"
                                                               ng-value="1">Yes</md-radio-button>
                                              <md-radio-button flex class="margin-top-0 margin-left-10 margin-right-0"
                                                               ng-value="0">No</md-radio-button>
                                              <md-radio-button flex class="margin-top-0 margin-left-10"
                                                               ng-value="2">N/A (Not Applicable)</md-radio-button>
                                            </md-radio-group>
                                          </md-input-container>
                                      </td>
                                    </tr>-->
                                    <tr>
                                      <th class="width-150">
                                        <p class="label-container">Priority<span>&nbsp;</span></p>
                                      </th>
                                      <td colspan="5">
                                        <md-input-container flex="100">
                                          <input type="number" min="0" step="0.01" name="displayOrder" ng-model="vm.errorCodeModel.displayOrder" max="1000" class="width-100">
                                          <div ng-messages="vm.ErrorcodeForm.displayOrder.$error" role="alert">
                                            <div ng-message="invalid || max || min">
                                              <span>{{vm.CORE_MESSAGE_CONSTANT.INVALID}}</span>
                                            </div>
                                          </div>
                                        </md-input-container>
                                        <span class="font-size-10"><b>Note:In BOM if have Multiple error in same part then based on this priority color will display</b></span>
                                      </td>
                                    </tr>
                                    <tr>
                                      <th class="width-150">
                                        <p class="label-container">Narrative<span>&nbsp;</span></p>
                                      </th>
                                      <td colspan="5">
                                        <div class="cm-text-angular-scroll">
                                          <md-input-container class="md-block margin-0" flex="100">
                                            <text-angular class="RFQ-info-text-area text-angular-editor-scroll" ta-toolbar="vm.taToolbar.INLINE" cg-busy-loading="vm.cgBusyLoading" ng-class="{'text-angular-custom-border':vm.ErrorcodeForm.narrative.$error.taMaxText}" ng-model="vm.errorCodeModel.narrative"
                                                          name="narrative"
                                                          ta-max-text="{{vm.taToolbar.MAX_LENGTH}}"></text-angular>
                                          </md-input-container>
                                        </div>
                                        <span class="font-size-10"><b>Note: System Variable not allow</b></span>
                                      </td>
                                    </tr>
                                    <tr>
                                      <th class="width-150"></th>
                                      <td colspan="5">
                                        <md-input-container class="md-block" ng-class="vm.themeClass" flex="100" flex-xs="100" disabled="disabled">
                                          <md-button class="md-default margin-0 md-raised black-500-fg" ng-click="vm.getColor($event,vm.errorCodeModel)"
                                                     style="background-color:{{vm.errorCodeModel.errorColor}} !important">Select Color Code</md-button>
                                          <div ng-messages="vm.ErrorcodeForm.errorColor.$error"
                                               role="alert">
                                            <div ng-if="vm.defectCategory.errorColor.length>20">
                                              <span>{{vm.getMaxLengthValidation(20, vm.ErrorcodeForm.errorColor.$viewValue.length)}}</span>
                                            </div>
                                          </div>
                                        </md-input-container>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div flex="30" flex-md="50" flex-lg="50" flex-gt-lg="30" style="margin-left:12px;">
                        <div class="price-tables manage-standard" flex="100" layout="row" layout-wrap>
                            <div class="price-table margin-0 style-1 md-whiteframe-1dp" layout="column" flex="100" flex-xs="100">
                                <div class="rfq_errorcode_padding md-primary-bg padding-5">
                                    <span>System Variables</span>
                                </div>
                                <div class="padding-5 font-size-14">
                                    Note: Click on the variable will copy/paste selected variable at current cursor position
                                </div>
                                <md-list class="cm-system-variable">
                                    <md-list-item ng-repeat="item in vm.systemVariableList" layout="row" style="max-height:20px;font-size:15px;" ng-click="vm.addVariable(item.name);">
                                        {{::item.name}}
                                    </md-list-item>
                                </md-list>
                            </div>
                        </div>
                    </div>
                </div>
                <div layout="row" flex="100" class="margin-top-5" layout-sm="column">
                    <div class="cm-section-main" flex="100">
                        <div class="cm-section-header">
                            <h2>Restrict Transaction Settings</h2>
                        </div>
                        <div class="cm-section-inner" layout="row" layout-wrap>
                            <div flex="100" class="border-bottom-gray">
                                <div flex="100" layout="row" layout-wrap>
                                    <div flex="25" ng-repeat="item in vm.categoryList">
                                        <div ng-if="item.name" class="errorcodelist">
                                            <md-checkbox ng-model="item.isChecked" name="category{{$index}}" id="category{{$index}}">
                                                <span>{{item.name}}</span>
                                            </md-checkbox>
                                            <md-icon class="icon-question-mark-circle help-icon margin-right-0" ng-if="item.description">
                                                <md-tooltip md-direction="top">
                                                    {{item.description}}
                                                </md-tooltip>
                                            </md-icon>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-10" flex="100" flex-xs="100" layout="row" layout-wrap>
                                <span class="font-size-10"><b>Note:Select Multiple Error Code to apply Restriction Transaction Setting by selecting restriction options.</b></span>
                                <div layout="row" flex="100" layout-wrap layout-align="space-between center">
                                    <div layout="row" flex="50" layout-align="start center">
                                        <div layout="column">
                                            <md-button id="selectBtn" class="md-raised md-primary margin-left-0"
                                                       ng-disabled="vm.errorCodeLegendList.length == 0"
                                                       ng-click="vm.SelectAllErrorCode($event)">
                                                {{vm.SelectAllErrorFn() ? 'Deselect All' : 'Select All'}}
                                            </md-button>
                                        </div>
                                    </div>
                                    <div class="md-subheader-inner selectedcount margin-bottom-5" flex="87" layout="column">
                                        <div class="md-subheader-content margin-0" no-translate-class><span>{{selectedErrorCodeList.length}}</span> Error Code(s) Selected</div>
                                    </div>
                                </div>
                                <div flex="100" flex-xs="100" layout="row" class="mobilesearch userpermissionhead">
                                    <md-input-container md-no-float class="md-block error-none no-label clickedsearch" flex flex-xs="75">
                                        <input id="SearchErrorCodeText" type="text"
                                               placeholder="Type here to search error codes"
                                               ng-model="vm.SearchErrorCodeText"
                                               ng-keyup="vm.SearchErrorCode(vm.errorCodeLegendList, vm.SearchErrorCodeText)"
                                               custom-blur="vm.SearchOperation(vm.errorCodeLegendList, vm.SearchErrorCodeText)">
                                    </md-input-container>
                                    <md-button class="md-raised md-primary md-ink-ripple margin-0"
                                               ng-disabled="!vm.SearchErrorCodeText"
                                               ng-click="vm.SearchErrorCodeText='';vm.SearchErrorCode(vm.errorCodeLegendList, vm.SearchErrorCodeText);">
                                        Clear
                                    </md-button>
                                </div>
                                <div class="price-tables manage-standard cm-update-error-code-popup-list" flex="100" layout-wrap ng-if="vm.errorCodeLegendList.length > 0">
                                    <div class="style-1" layout="column" flex="100">
                                        <md-list class="operation-popup" layout="row" flex="100" layout-wrap>
                                            <md-list-item flex="33" class="cm-error-code-list-details" ng-repeat="error in vm.errorCodeLegendList | orderBy: 'displayOrder'" layout="row" layout-align="start stretch">
                                                <md-checkbox class="margin-0" flex="100" name="errorCode{{$index}}" id="errorCode{{$index}}" ng-model="error.selected" ng-change="vm.AddToSelectedErrorcode(error);">
                                                </md-checkbox>
                                                <div flex="100" class="text-main cm-error-code-list-details">
                                                    <i class="icon-checkbox-blank-circle-outline normal"></i>
                                                    <i class="icon-check-circle checked"></i>
                                                    {{ error.displayName }}
                                                </div>
                                            </md-list-item>
                                        </md-list>
                                    </div>
                                </div>
                                <div flex="100" class="md-1-line margin-0 cursor-not-allow"
                                     ng-if="vm.errorCodeLegendList.length == 0" ui-sortable-selectable>
                                    <div class="empty-state text-center">
                                        <div class="emty-icon">
                                            <img ng-src="{{vm.EmptyMesssagePart.IMAGEURL}}" />
                                        </div>
                                        <p class="empty-state-title font-size-2 useadded-emptytxt">
                                            {{vm.EmptyMesssagePart.EMPTY_SEARCH_MESSAGE}}
                                        </p>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </md-content>
        </md-dialog-content>
        <md-dialog-actions layout="row">
            <md-button class="md-raised" ng-click="vm.cancel()">Cancel</md-button>
            <!-- Check vm.isChange flag for color picker dirty object-->
            <md-button class="md-primary md-raised" ng-click="vm.saveErrorCode();" aria-label="Submit" ng-class="{'md-formdirty': vm.checkFormDirty(vm.ErrorcodeForm) }">Save</md-button>
        </md-dialog-actions>
    </form>
</md-dialog>
