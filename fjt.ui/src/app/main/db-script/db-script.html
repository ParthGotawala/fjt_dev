<div id="forms" class="page-layout simple fullwidth doc-page breadcrumb-fixed" layout="column" cg-busy="{promise:vm.cgBusyLoading}">
    <div class="header md-accent-bg" layout="row" layout-align="space-between center">
        <div class="white-fg" layout="column" layout-align="space-between center">
            <div class="h2" layout="row" layout-align="start center">
                <md-icon class="icon-script"></md-icon>&nbsp;
                <span class="header-title">DB Script</span>
            </div>
        </div>
        <div class="disable-buttons">
          <md-button class="md-primary md-raised" ng-if="vm.isAllowedToExecuteDBScript && !vm.dbscript.isValidUserToExecuteDbScript" ng-click="vm.refreshForExecuteDbScript()">
            Refresh
          </md-button>
          <md-button class="md-primary md-raised" ng-click="vm.generateEntityJSON()">
            Generate Data Tracking Entity File
          </md-button>
          <md-button class="md-primary md-raised" ng-if="vm.isAllowedToExecuteDBScript && vm.dbscript.isValidUserToExecuteDbScript" ng-click="vm.generateJSON()">
            Generate Message File
          </md-button>
          <md-button class="md-primary md-raised" ng-if="vm.isAllowedToExecuteDBScript && vm.dbscript.isValidUserToExecuteDbScript" ng-click="vm.executeMsgDBScript()">
            Execute DB Script
          </md-button>
          <md-button class="md-primary md-raised" ng-if="vm.isAllowedToExecuteDBScript && vm.dbscript.isValidUserToExecuteDbScript" ng-click="vm.confirmExecuteIdentityDBScript()">
            Execute Identity DB Script
          </md-button>
        </div>
    </div>
    <div class="content-card padding-top-30" layout="column" flex>
        <div layout="row">
            <ms-form-wizard flex>
              <form name="vm.formDbScriptDetails" layout="row" layout-wrap class="md-inline-form padding-bottom-0" ms-form-wizard-form novalidate>
                <div layout="row" flex="100" class="padding-top-20 blog equipmenmain" layout-align="center center">
                  <span flex="20"><b>Host :</b>  {{vm.dbscript.host}}</span>
                  <span flex="20"><b>DbName :</b>   {{vm.dbscript.dbName}}</span>
                  <span flex="60">
                    <b>Branch(Max Build Number) : </b>
                    <span ng-repeat="item in vm.dbscript.branches">
                      {{item.branchName}}({{item.maxBuildNumber}})
                      {{((vm.dbscript.branches.length - 1) !== $index )? '/' : ''}}
                    </span>
                  </span>
                </div>
                <div layout="row" flex="100" class="padding-top-20 blog equipmenmain" layout-align="center center">
                  <span flex="20"><b>Host :</b>  {{vm.dbscript.host}}</span>
                  <span flex="20"><b>DbName :</b>   {{vm.dbscript.identityDBName}}</span>
                  <span flex="60">
                    <b>Branch(Max Build Number) : </b>
                    <span ng-repeat="item in vm.dbscript.identityBranches">
                      {{item.branchName}}({{item.maxBuildNumber}})
                      {{((vm.dbscript.identityBranches.length - 1) !== $index )? '/' : ''}}
                    </span>
                  </span>
                </div>

                <div layout="row" flex="100" class="padding-top-10">
                  <md-input-container flex="50">
                    <div layout="row" layout-align="center center">
                      <span>
                        <b><u>Enter Script</u></b>
                        <md-button class="md-primary md-raised" ng-if="vm.dbscript.script"
                                   ng-click="vm.clearScript()">Clear</md-button>
                      </span>
                    </div>

                    <textarea style="max-height:400px;min-height:400px; resize: none;overflow-y: auto;"
                              name="Script" ng-model="vm.dbscript.script" rows="15" cols="50"></textarea>
                  </md-input-container>
                  <md-input-container flex="50">
                    <div layout="row" layout-align="center center">
                      <span>
                        <b><u>Formatted Script</u></b>
                        <md-button class="md-primary md-raised" ng-click="vm.copyTextToClipBoard()"
                                   ng-if="vm.formattedStringResultArr && vm.formattedStringResultArr.length > 0">Copy</md-button>
                      </span>
                    </div>
                    <!--<pre contentEditable="true" id="formattedString" layout="row" ng-bind-html="vm.formattedStringResultArr"></pre>-->
                    <textarea style="max-height:400px;min-height:400px; resize: none;overflow-y: auto;"
                              id="formattedString" name="Script" ng-model="vm.formattedStringResultArr" rows="15"></textarea>
                  </md-input-container>
                </div>
                <div flex="100" class="fab-footer fab-footer-right" layout="row" layout-align="start start">
                  <md-button class="md-secondary md-fab" name="btnSave" ng-click="vm.forMatScriptAsStringExecution();"
                             ng-disabled="!vm.dbscript.script">
                    <md-tooltip md-direction="top">Convert to String Format</md-tooltip>
                    <md-icon class="icon-transfer"></md-icon>
                  </md-button>
                </div>
              </form>
            </ms-form-wizard>
        </div>
    </div>
</div>
