<div id="forms" class="page-layout simple fullwidth doc-page breadcrumb-fixed cm-custom-label-common" layout="column" cg-busy="{promise:vm.cgBusyLoading}">
  <div class="content-card" layout="column" flex>
    <div flex="{{vm.isShowSideNav==false?100:80}}" flex-sm="{{vm.isShowSideNav==false?100:75}}">
      <div layout="row" flex="100" class="work-order-bg-main cm-postatus-wo-op-bg cm-section-main border-0" layout-wrap>
        <div ng-if="vm.colorCode" class="background-color-line" style="background: {{vm.colorCode}}"><md-tooltip ng-if="vm.selectedClassName">{{vm.selectedClassName}}</md-tooltip></div>
        <div layout="row" layout-wrap flex="100" class="margin-bottom-10 cm-section-inner overflow-auto-rs">
          <table width="100%" class="cm-table-input-main cm-wo-header-main opration-table">
            <tr>
              <th>
                <p class="label-container">
                  <a tabindex="-1" class="cm-text-decoration"
                     ng-mousedown="vm.goToWorkorderList();$event.preventDefault();">
                    {{vm.allLabelConstant.Workorder.WO}}
                  </a>:
                </p>
              </th>
              <td>
                <span class="value">
                  <a tabindex="-1" class="cm-text-decoration"
                     ng-mousedown="vm.goToWorkorderDetails(vm.workordermst.woID);$event.preventDefault();">
                    {{vm.workordermst.woNumber}}
                  </a>
                </span>
              </td>

              <th>
                <p class="label-container">
                  {{vm.allLabelConstant.Workorder.Version}}:
                </p>
              </th>
              <td>

                <span class="value">
                  {{vm.workordermst.woVersion}}
                </span>
              </td>
              <th>
                <p class="label-container">
                  <a tabindex="-1" href="" class="cm-text-decoration margin-0"
                     ng-mousedown="vm.goToAssemblyList();$event.preventDefault();">
                    {{vm.allLabelConstant.Assembly.ID}}
                  </a>:
                </p>
              </th>
              <td>
                <span class="value">
                  <common-pid-code-label-link component-id="vm.assyobj.componentAssembly.id"
                                              label="vm.allLabelConstant.Assembly.ID" value="vm.assyobj.componentAssembly.PIDCode"
                                              is-copy="true" rohs-icon="vm.RoHSLeadFreeIcon"
                                              rohs-status="vm.RoHSLeadFreeText" is-formated="true"
                                              is-assembly="true"
                                              is-custom-part="vm.assyobj.componentAssembly.isCustom">
                </span>
              </td>
              <th>
                <p class="label-container">
                  {{vm.allLabelConstant.Assembly.InternalVersion}}:
                </p>
              </th>
              <td>

                <span class="value">
                  {{vm.assyobj.componentAssembly && vm.assyobj.componentAssembly.componentbomSetting && vm.assyobj.componentAssembly.componentbomSetting[0].liveVersion ? vm.assyobj.componentAssembly.componentbomSetting[0].liveVersion : '-'}}
                </span>
              </td>
              <th>
                <p class="label-container">
                  {{vm.allLabelConstant.Workorder.Status}}:
                </p>
              </th>
              <td>
                <span class="label-box" ng-class="vm.getWoStatusClassName(vm.workordermst.woSubStatus)">{{vm.getWoStatus(vm.workordermst.woSubStatus)}}</span>
              </td>
            </tr>
            <tr>
              <th>
                <p class="label-container">
                  <a tabindex="-1" href="" class="cm-text-decoration margin-0"
                     ng-mousedown="vm.goToSalesOrderList();$event.preventDefault();">
                    {{vm.allLabelConstant.Workorder.PO}}:
                  </a>
                </p>
              </th>

              <td>

                <span class="value">
                  <a tabindex="-1" class="cm-text-decoration" ng-click="vm.goToManageSalesOrder(vm.salesordermstDet.id);">
                    {{vm.salesordermstDet.poNumber}}
                  </a>
                </span>
              </td>
              <th>
                <p class="label-container">
                  {{vm.allLabelConstant.Workorder.WODate}}:
                </p>
              </th>
              <td>
                <span class="value">
                  {{vm.workordermst.createdAt |  date :  vm.DateFormat }}
                </span>
              </td>
              <th>
                <p class="label-container">
                  {{vm.allLabelConstant.Assembly.Assy}}:
                </p>
              </th>
              <td>

                <span class="value">
                  <common-pid-code-label-link component-id="vm.assyobj.componentAssembly.id"
                                              label="vm.allLabelConstant.Assembly.MFGPN" value="vm.assyobj.componentAssembly.mfgPN"
                                              is-copy="true" rohs-icon="vm.RoHSLeadFreeIcon"
                                              rohs-status="vm.RoHSLeadFreeText" is-formated="true"
                                              is-assembly="true"
                                              is-custom-part="vm.assyobj.componentAssembly.isCustom">
                  </common-pid-code-label-link>
                </span>
              </td>
              <th>
                <p class="label-container">
                  {{vm.allLabelConstant.Assembly.NickName}}:
                </p>
              </th>
              <td>
                <span class="value">
                  {{vm.assyobj.componentAssembly.nickName}}
                </span>
              </td>
              <th>
                <p class="label-container">
                  To {{vm.allLabelConstant.Workorder.WO}}:
                </p>
              </th>
              <td ng-if="vm.isTerminated">

                <span class="value">
                  {{vm.TransferWorkorder}}
                </span>
              </td>
            </tr>
            <tr>
              <th>
                <p class="label-container">
                  <a tabindex="-1" href="" class="cm-text-decoration margin-0"
                     ng-mousedown="vm.goToSalesOrderList();$event.preventDefault();">
                    {{vm.allLabelConstant.SalesOrder.SO}}
                  </a>:
                </p>
              </th>
              <td>
                <span class="value">
                  <a tabindex="-1" class="cm-text-decoration" ng-click="vm.goToManageSalesOrder(vm.salesordermstDet.id);">
                    {{vm.salesordermstDet.salesOrderNumber}}
                  </a>
                </span>
              </td>
              <th>
                <p class="label-container">
                  {{vm.allLabelConstant.Workorder.POQty}}:
                </p>
              </th>
              <td>
                <span class="value">
                  {{vm.PoQty | numberWithoutDecimal}}
                </span>
              </td>
              <th>
                <p class="label-container">
                  {{vm.allLabelConstant.Workorder.BuildQty}}:
                </p>
              </th>
              <td>

                <span class="value">
                  {{vm.workordermst.buildQty | numberWithoutDecimal}}
                </span>
              </td>
              <th>
                <p class="label-container">
                  {{vm.allLabelConstant.Workorder.CECO}}:
                </p>
              </th>
              <td>
                <span class="value">
                  {{vm.workordermst.ECORemark ? vm.workordermst.ECORemark : '-'}}
                </span>
              </td>
              <th>
                <p class="label-container">
                  {{vm.allLabelConstant.Workorder.IECO}}:
                </p>
              </th>
              <td>
                <span class="value">
                  {{vm.workordermst.FCORemark ? vm.workordermst.FCORemark : '-'}}
                </span>
              </td>
            </tr>
            <tr>
              <td rowspan="2" ng-if="vm.workordermst.isStopWorkorder">
                <img class="wostop-icon-image md-raised md-warn md-icon-button"
                     src="../../../../../assets/images/logos/stop.png" />
              </td>
            </tr>
            <tr ng-if="vm.workordermst.isStopWorkorder">
              <th>
                <p class="label-container">
                  Comment:
                </p>
              </th>
              <td colspan="8">
                <span class="value">
                  {{vm.workordermst.workorderTransHoldUnhold[0].reason | limitTo: vm.limit }}<span class="cursor-pointer color-viewmore" ng-click="vm.expandcolapse()">{{vm.workordermst.workorderTransHoldUnhold[0].reason.length > vm.limit ? 'Show more...' : ''}}</span>
                </span>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div flex="100" ng-if="vm.qtyProgressDataforWoAssy && vm.qtyProgressDataforWoAssy.length > 0">
        <div layout-align="end-center" layout="row">
          <div layout="row" flex="65" class="margin-top-15 margin-bottom-15" layout-align="end-center">
            <div class="progress-bar" role="progressbar"
                 ng-repeat="progressItem in vm.qtyProgressDataforWoAssy | orderBy : 'orderBy'"
                 style="width:{{progressItem.valueInPer}}%;background-color:{{progressItem.color}}">
              {{progressItem.valueInPer}}%
              <md-tooltip md-direction="top">{{progressItem.name}}:&nbsp;{{progressItem.value}}&nbsp;&nbsp;( {{progressItem.valueInPer}} %)</md-tooltip>
            </div>
          </div>
        </div>
        <div layout="row" layout-align="end-center" flex="100" class="margin-bottom-15">
          <span layout="row" layout-align="end-center" ng-repeat="legendItem in vm.woOpPOStatusLegendList | orderBy : 'orderBy'">
            <span class="cm-po-status-legend-color" ng-style="{'background-color':legendItem.BackgroundColor}"></span>
            <span class="cm-po-status-legend-list">{{legendItem.Key}}</span>
          </span>
        </div>
      </div>
      <div layout="row" layout-align="end end" ng-if="vm.workOrderOperationList.length || (vm.workOrderOperationList.length == 0 && vm.query.search.length > 0)">
        <div layout="row" flex-xs="50">
          <md-input-container class="md-block search-header margin-0 error-none">
            <input type="text" ng-model="vm.query.search" ng-change="vm.filterWoOpData()"
                   ng-model-options="{debounce: vm.debounceConstant.mdDataTable }" placeholder="Search">
          </md-input-container>
          <md-button class="md-primary md-raised margin-0 margin-right-5-imp" ng-click="vm.query.search = '';vm.refreshPODetails()" ng-disabled="!vm.query.search">
            Clear
          </md-button>
          <md-button class="md-primary md-raised margin-0" ng-click="vm.query.search = '';vm.refreshPODetails();">
            Refresh
          </md-button>
        </div>
      </div>
      <div class="content tabletext fullpage-datatable display-block margin-top-10" layout="column" flex="100">
        <md-table-container flex="100" class="cm-postatus-wo-op" ng-if="vm.isWOOPListAvailable">
          <table md-table class="md-data-table table-row-select cm-scroll-table ">
            <thead md-head>
              <tr md-row>
                <th md-column class="padd" width="50">
                  #
                </th>
                <th md-column class="padd width-180">
                  {{vm.allLabelConstant.Operation.Short_OP}}
                </th>
                <th md-column class="padd" width="85">
                  {{vm.allLabelConstant.Operation.Short_Version}}
                </th>
                <th md-column class="padd" width="110">
                  {{vm.allLabelConstant.Operation.Status}}
                </th>
                <th md-column class="padd" width="105">
                  Halt Comment
                </th>
                <th md-column md-numeric class="padd" width="95">
                  Finished Qty
                </th>
                <th md-column md-numeric class="padd" width="100">
                  {{vm.allLabelConstant.Traveler.AvailableQty}}
                </th>
                <th md-column md-numeric class="padd" width="80">
                  {{vm.allLabelConstant.Traveler.IssueQty}}
                </th>
                <th md-column md-numeric class="padd" width="95">
                  Loop OP Qty
                </th>
                <th md-column md-numeric class="padd" width="90">
                  Passed Qty
                </th>
                <th md-column md-numeric class="padd" width="140">
                  Defect Observed Qty
                </th>
                <th md-column md-numeric class="padd" width="145">
                  Rework Required Qty
                </th>
                <th md-column md-numeric class="padd" width="100">
                  {{vm.allLabelConstant.Traveler.ScrappedQty}}
                </th>
                <th md-column md-numeric class="padd" width="190">
                  {{vm.allLabelConstant.Traveler.BoardWithMissingPartsQty}}
                </th>
                <th md-column md-numeric class="padd" width="105">
                  {{vm.allLabelConstant.Traveler.BypassedQty}}
                </th>
                <th md-column md-numeric class="padd" width="110">
                  Transferred Qty
                </th>
                <th md-column md-numeric class="padd" width="95">
                  {{vm.allLabelConstant.Shipped.ShippedQty}}
                </th>
              </tr>
            </thead>
            <tbody md-body>
              <tr md-row ng-repeat="item in vm.workOrderOperationList">
                <td md-cell class="padd" width="50">{{$index+1}}</td>
                <td md-cell class="padd width-180">
                  {{item.opFullName}}
                  <span class="cursor-pointer" ng-if="item[vm.Stock_Column.IS_REWORK_OPERATION]=='Yes'">
                    <md-icon md-font-icon="icon-worker"></md-icon>
                    <md-tooltip>Rework Operation</md-tooltip>
                  </span>
                  <span class="cursor-pointer" ng-if="item.isLoopOperation">
                    <md-icon md-font-icon="icon-rotate-3d"></md-icon>
                    <md-tooltip>Loop Operation</md-tooltip>
                  </span>
                </td>
                <td md-cell class="padd" width="85">{{item[vm.Stock_Column.OP_VERSION]}}</td>
                <td md-cell class="padd" width="110"><span class="label-box" ng-class="item[vm.Stock_Column.OP_STATUS]=='Disabled'?'label-danger':item[vm.Stock_Column.IS_STOP_OPERATION]!='No'?'label-danger':item[vm.Stock_Column.OP_STATUS]=='Published'?'label-primary':'label-warning'">{{item[vm.Stock_Column.OP_STATUS]=='Terminated'?item[vm.Stock_Column.OP_STATUS]:item[vm.Stock_Column.IS_STOP_OPERATION]=='No'?item[vm.Stock_Column.OP_STATUS]:'Halt'}}</span></td>
                <td md-cell class="padd" width="105"><span class="cursor-pointer">{{item.reason | limitTo: 20}}{{item.reason.length > 20 ? '...' : ''}}<md-tooltip ng-if="item.reason" md-direction="top">{{item.reason}}</md-tooltip></span></td>
                <td md-cell class="padd" width="95">{{item[vm.Stock_Column.OP_STOCK_QTY] | numberWithoutDecimal}}</td>
                <td md-cell class="padd" width="100">{{item[vm.Stock_Column.OP_STATUS]=='Disabled' && item.isTerminated=='No' && item[vm.Stock_Column.MFG_QTY_REQUIRED] == "Yes"?0:item.unprocess | numberWithoutDecimal}}</td>
                <td md-cell class="padd" width="80">{{item[vm.Stock_Column.ISSUE_QTY] | numberWithoutDecimal}}</td>
                <td md-cell class="padd" width="95">{{item.LoopOperationQty | numberWithoutDecimal}}</td>
                <td md-cell class="padd" width="90">{{item[vm.Stock_Column.OP_PASSED_QTY] | numberWithoutDecimal}}</td>
                <td md-cell class="padd" width="140">{{item[vm.Stock_Column.OP_DEFECT_OBSERVED_QTY] | numberWithoutDecimal}}</td>
                <td md-cell class="padd" width="145">{{item[vm.Stock_Column.OP_REWORK_REQUIRED_QTY] | numberWithoutDecimal}}</td>
                <td md-cell class="padd" width="100">{{item[vm.Stock_Column.OP_SCRAPED_QTY] | numberWithoutDecimal}}</td>
                <td md-cell class="padd" width="190">{{item.OPBoardWithMissingPartsQty | numberWithoutDecimal}}</td>
                <td md-cell class="padd" width="105">{{item.OPBypassedQty | numberWithoutDecimal}}</td>
                <td md-cell class="padd" width="110">{{item[vm.Stock_Column.TRANSFER_QTY] | numberWithoutDecimal}}</td>
                <td md-cell class="padd" width="95">{{item[vm.Stock_Column.SHIPPED_QTY] | numberWithoutDecimal}}</td>
              </tr>
            </tbody>
            <tfoot md-foot>
              <tr md-row ng-if="vm.workOrderOperationList && vm.workOrderOperationList.length > 0">
                <td md-cell width="50"></td>
                <td md-cell class="width-180"></td>
                <td md-cell width="85"></td>
                <td md-cell width="110"></td>
                <td md-cell width="105"></td>
                <td md-cell width="95"></td>
                <td md-cell width="100"></td>
                <td md-cell width="80"></td>
                <td md-cell width="95"></td>
                <td md-cell width="90"></td>
                <td md-cell width="140"></td>
                <td md-cell width="145"></td>
                <td md-cell class="padd" width="100"><strong>Total: {{vm.totalOfScrappedQty}}</strong></td>
                <td md-cell width="190"></td>
                <td md-cell width="105"></td>
                <td md-cell width="110"></td>
                <td md-cell class="padd" width="95"><strong>Total: {{vm.totShippedQty}}</strong></td>
              </tr>
            </tfoot>
          </table>
        </md-table-container>
        <div class="empty-state full-height-90" layout="row" layout-wrap layout-align="center center"
             ng-if="!vm.workOrderOperationList.length && vm.query.search.length > 0">
          <div class="emty-icon" flex="100">
            <img ng-src="{{vm.emptySearch.IMAGEURL}}" />
          </div>
          <p class="empty-state-title" flex="100">{{vm.emptySearch.MESSAGE}}</p>
        </div>
      </div>
      <div class="empty-state full-height margin-top-80" layout="row" layout-wrap layout-align="center center"
           ng-if="!vm.workOrderOperationList.length && !vm.query.search.length">
        <div class="emty-icon" flex="100">
          <img ng-src="{{vm.CommonEmptyMessage.IMAGEURL}}" />
        </div>
        <p class="empty-state-title" flex="100">{{vm.CommonEmptyMessage.MESSAGE}}</p>
      </div>
    </div>
  </div>
</div>
