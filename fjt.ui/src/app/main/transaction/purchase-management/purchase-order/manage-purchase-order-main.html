
<div id="forms" class="page-layout simple fullwidth doc-page breadcrumb-fixed cm-warehouse-bin-navbar cm-custom-label-common" layout="column" cg-busy="{promise:vm.cgBusyLoading}">
    <div class="header md-accent-bg" layout="row" layout-align="space-between center">

        <div class="white-fg" layout="row" layout-align="start center" flex="35">
            <div>
                <md-button class="goto-rfq-button md-icon-button cm-back-btn-p-m" type="button" aria-label="Go to Purchase Order List" ng-click="vm.goBack()">
                    <md-icon md-font-icon="icons-backarrow" class="material-icons icons-backarrow cm-back-btn">
                    </md-icon>
                    <md-tooltip>Back to Purchase Order List</md-tooltip>
                </md-button>
            </div>
            <div layout="column">
                <div layout="column">
                    <div>
                        <pagetitle is-list="false"
                                   is-display-menu-name="true"
                                   prefix-content="vm.poId ? 'Update' : 'Add'"
                                   suffix-content="vm.poId ? ('#: ' + vm.poNumber) : ''"
                                   prefix-page-title="vm.poNumber ? vm.poNumber: ''"></pagetitle>
                        <md-tooltip md-direction="right" ng-if="vm.poNumber">{{vm.poNumber}}</md-tooltip>
                    </div>
                    <div layout="row" layout-align="start center">
                        <breadcrumbs></breadcrumbs>
                    </div>
                </div>
            </div>
            <div layout layout-wrap ng-if="vm.autoCompletePurchaseOrder" class="cm-header-search-add-container" flex="40">
                <div flex="100">
                    <md-input-container ng-if="vm.autoCompletePurchaseOrder" class="width-100p autocompletecustom margin-0 widget-dashboard-search-area" flex="100" flex-gt-xs="100">
                        <custom-auto-complete-search on-search-fn="vm.autoCompletePurchaseOrder.onSearchFn"
                                                     column-name="vm.autoCompletePurchaseOrder.columnName"
                                                     key-column-name="vm.autoCompletePurchaseOrder.keyColumnName"
                                                     input-name="vm.autoCompletePurchaseOrder.inputName"
                                                     placeholder-name="vm.autoCompletePurchaseOrder.placeholderName"
                                                     key-column-id="vm.autoCompletePurchaseOrder.keyColumnId"
                                                     is-required="vm.autoCompletePurchaseOrder.isRequired"
                                                     is-addnew="vm.autoCompletePurchaseOrder.isAddnew"
                                                     callback-fn="vm.autoCompletePurchaseOrder.callbackFn"
                                                     on-select-callback-fn="vm.autoCompletePurchaseOrder.onSelectCallbackFn">
                        </custom-auto-complete-search>
                    </md-input-container>
                </div>
                <div class="cm-square-icon-btn pt-2">
                    <md-button class="md-icon-button mv-0-imp margin-right-5-imp md-primary md-raised" ng-if="vm.poId" ng-click="vm.goToPurchaseOrderDetail(null, false)" ng-disabled="vm.isReadOnly">
                        <md-icon md-font-icon="t-icons-po add-icon" class="material-icons"></md-icon>
                        <md-tooltip>Add Purchase Order In New Tab</md-tooltip>
                    </md-button>
                    <md-button class="md-icon-button mv-0-imp margin-right-5-imp md-primary md-raised" ng-if="vm.poId" ng-click="vm.goToPurchaseOrderDetail(null, true)" ng-disabled="vm.isReadOnly">
                        <md-icon md-font-icon="t-icons-po add-icon same-tab-icon" class="material-icons"></md-icon>
                        <md-tooltip>Add Purchase Order</md-tooltip>
                    </md-button>
                </div>
            </div>
        </div>
        <div layout="row" flex>
            <div layout="row" flex="100" layout-wrap>
                <div flex layout="row" layout-wrap>
                    <div flex="100" layout-wrap>
                        <table cellspacing="0" cellpadding="0" class="cm-header-data-table cm-po-header-data-table">
                            <tbody>

                                <tr>
                                    <th>
                                        <a class="cursor-pointer text-underline" ng-click="vm.goTopurchaseOrder();">
                                            PO#:
                                        </a>
                                    </th>
                                    <td>
                                        <span class="cm-data">
                                            <md-tooltip ng-if="vm.poNumber">{{vm.poNumber}}</md-tooltip>
                                            <b ng-if="vm.poNumber">
                                                {{vm.poNumber}}
                                            </b>
                                        </span>
                                        <copy-text ng-if="vm.poNumber" label="'PO#'" text="vm.poNumber"></copy-text>

                                    </td>
                                    <th>PO Date:</th>
                                    <td>
                                        <span class="cm-date">
                                            <b>{{vm.poDate | date: vm.DefaultDateFormat}}</b>
                                        </span>
                                    </td>

                                </tr>

                <tr>
                  <th>
                    SO#:
                  </th>
                  <td>
                    <span class="cm-data">
                      <md-tooltip ng-if="vm.soNumber">
                        {{vm.soNumber}}
                      </md-tooltip>
                      <b ng-if="vm.soNumber">{{vm.soNumber}}</b>
                      <b ng-if="!vm.soNumber">-</b>
                    </span>
                    <copy-text ng-if="vm.soNumber" label="'SO#'"
                               text="vm.soNumber"></copy-text>
                  </td>
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goToSupplierList();">
                      Supplier:
                    </a>
                  </th>
                  <td>
                    <span class="cm-name"
                          ng-class="{'text-underline': vm.supplierName, 'cursor-pointer': vm.supplierName}"
                          ng-click="vm.supplierName ? vm.goToSupplierDetail() : ''">
                      <md-tooltip class="tt-multiline cm-white-space-normal max-width-420 pv-5" ng-if="vm.supplierName">
                        {{vm.supplierName}}
                      </md-tooltip>
                      <b>{{vm.supplierName?vm.supplierName:'-'}}</b>
                    </span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div layout="row" layout-wrap layout-align="start center" class="cm-square-icon-btn">
        <span class="label-box padding-5-imp width-100 margin-right-10" ng-class="vm.getPONumberStatusClassName(vm.status)"
              ng-if="vm.activeTab !== vm.tabList[0].id">{{vm.getPOStatus(vm.status)}}</span>
        <div layout="column" class="cm-header-draft-btn" layout-wrap layout-align="center center" ng-if="vm.activeTab === vm.tabList[0].id">
            <md-menu-bar id="user-menu" class="ph-10">
                <md-menu md-position-mode="left bottom">
                    <md-button class="user-button" ng-click="$mdOpenMenu()"
                               aria-label="User settings" ng-disabled="!vm.poId || vm.isDisabled || vm.isReadOnly">
                        <div layout="row" layout-align="space-between center">
                            <span class="username">{{vm.getPOStatus(vm.status)}}</span>
                            <md-icon md-font-icon="icon-chevron-down"
                                     class="icon s16"></md-icon>
                        </div>
                    </md-button>
                    <md-menu-content width="3">
                        <md-menu-item ng-repeat="status in vm.purchaseOrderStatus | orderBy:'DisplayOrder'" ng-disabled="!vm.poId">
                            <md-button ng-click="vm.changePurchaseOrderStatus(status)">{{status.Name}}</md-button>
                        </md-menu-item>
                    </md-menu-content>
                </md-menu>
            </md-menu-bar>
            <div layout="row" layout-align="center center">
                <span ng-if="vm.label" class="cm-font-10 padding-bottom-8"><b>{{vm.label}}</b></span>
            </div>
        </div>
        <span class="label-box padding-5-imp width-100 cursor-pointer"
              ng-class="{'label-danger': vm.poWorkingStatus === vm.POWorkingStatusConstant.Canceled.id,
                        'label-warning': vm.poWorkingStatus === vm.POWorkingStatusConstant.InProgress.id,
                        'label-success': vm.poWorkingStatus === vm.POWorkingStatusConstant.Completed.id}">
            {{vm.poWorkingStatus === vm.POWorkingStatusConstant.Canceled.id ? vm.POWorkingStatusConstant.Canceled.value : vm.poWorkingStatus === vm.POWorkingStatusConstant.Completed.id ? vm.POWorkingStatusConstant.Completed.value : vm.POWorkingStatusConstant.InProgress.value}}
            <md-tooltip md-direction="top">
                PO Working Status
            </md-tooltip>
        </span>
        <span class="label-box label-danger margin-left-10" ng-if="vm.lockStatus === vm.PurchaseOrderLockStatus.Locked.id">
            Locked
            <md-tooltip md-direction="bottom" class="tt-multiline">
                Locked By: {{vm.lockedByName}} <br />
                Locked Date: {{vm.lockedAt}}
            </md-tooltip>
        </span>
        <div layout="row" layout-align="center center" flex>
          <div layout="column" ng-if="vm.poId && vm.activeTab === vm.tabList[0].id && vm.poWorkingStatus != vm.POWorkingStatusConstant.Canceled.id" class="ml-10">
            <md-button class="cm-feture-btn-color md-icon-button md-raised"
                       ng-disabled="!vm.isAllowToCancelPO || (vm.isAllowToCancelPO && vm.poWorkingStatus === vm.POWorkingStatusConstant.InProgress.id ? vm.isDisabledCancelPO ? true : false : true) || vm.isReadOnly"
                       ng-click="vm.isCancleReason($event)">
              <md-icon md-font-icon="t-icons-po cancel-icon" class="material-icons">
                <md-tooltip class="tooltip-height-auto" ng-bind-html="vm.cancelPOBtnTooltip"></md-tooltip>
              </md-icon>
            </md-button>
          </div>
          <div layout="column" ng-if="vm.poId && vm.activeTab === vm.tabList[0].id && vm.poWorkingStatus === vm.POWorkingStatusConstant.Canceled.id" class="ml-10 cm-square-icon-btn">
            <md-button class="cm-feture-btn-color md-icon-button md-raised"
                       ng-disabled="!vm.isAllowToCancelPO || vm.isReadOnly"
                       ng-click="vm.isCancleReason($event)">
              <md-icon md-font-icon="t-icons-undo cancel-icon" class="material-icons">
                <md-tooltip class="tooltip-height-auto" ng-bind-html="vm.undoPOBtnTooltip"></md-tooltip>
              </md-icon>
            </md-button>
          </div>
          <md-button ng-if="vm.poId && vm.activeTab === vm.tabList[0].id" class="md-icon-button md-primary md-raised ml-0" ng-disabled="vm.frmPurchaseOrder.$dirty || vm.PODetForm.$dirty || vm.isDuplicatePObtnDisabled || vm.isReadOnly" ng-click="vm.createDuplicatePO($event)">
            <md-icon md-font-icon="t-icons-duplicate-po" class="material-icons"></md-icon>
            <md-tooltip>Duplicate PO</md-tooltip>
          </md-button>
          <md-button ng-if="vm.poId && vm.activeTab === vm.tabList[0].id" class="md-icon-button md-primary md-raised ml-0" ng-disabled="vm.frmPurchaseOrder.$dirty || vm.PODetForm.$dirty || vm.isPrintDisable" ng-click="vm.printRecord(false)">
            <md-icon md-font-icon="icon-printer" class="material-icons"></md-icon>
            <md-tooltip>Print</md-tooltip>
          </md-button>
          <md-button ng-if="vm.poId && vm.activeTab === vm.tabList[0].id" class="md-icon-button margin-0 md-primary md-raised" ng-disabled="vm.frmPurchaseOrder.$dirty || vm.PODetForm.$dirty || vm.isDownloadDisabled" ng-click="vm.printRecord(true)">
            <md-icon md-font-icon="icon-download" class="material-icons"></md-icon>
            <md-tooltip>Download</md-tooltip>
          </md-button>
          <md-button ng-if="vm.poId" class="md-icon-button md-primary md-raised md-mini margin-right-0" ng-click="vm.openPurchaseOrderHistory($event)" ng-disabled="vm.isHistoryPopupOpen">
            <md-icon md-font-icon="t-icons-po-change-history" class="material-icons change-icon"></md-icon>
            <md-tooltip>{{vm.poHistoryTitle}}</md-tooltip>
          </md-button>
          <md-button class="md-primary md-raised"
                     ng-class="{'md-formdirty': vm.frmPurchaseOrder.$dirty || vm.PODetForm.$dirty}"
                     id="saveBtn" ng-click="vm.savePurchaseOrder();"
                     ng-if="vm.activeTab !== vm.tabList[1].id"
                     ng-disabled="vm.isSaveDisabled || vm.isReadOnly">
            Save
          </md-button>
          <md-menu-bar ng-if="vm.poId" class="pv-0" layout-align="start-center" layout="row">
            <md-menu md-position-mode="left bottom">
              <md-button class="md-primary md-icon-button pr-20" ng-click="vm.openMenu($mdMenu,$event)"
                         aria-label="User settings" md-prevent-menu-close="md-prevent-menu-close">
                <md-icon md-font-icon="icon-dots-vertical" class="icon s24"></md-icon>
              </md-button>
              <md-menu-content width="3">
                <md-menu-item>
                  <md-button ng-click="vm.deleteRecord($mdMenu,$event);"
                             ng-disabled="vm.isDisabledDelete || vm.isReadOnly"
                             ng-class="{'item-disabled': vm.isDisabledDelete || vm.isReadOnly}">
                    <md-icon md-font-icon="icon-trash" class="icon s24"></md-icon>
                    Delete PO
                  </md-button>
                </md-menu-item>
              </md-menu-content>
            </md-menu>
          </md-menu-bar>
        </div>
    </div>
  </div>

    <div class="content-card padding-top-side" layout="row" flex="100">
        <md-content flex="100" layout="column">
            <ms-form-wizard flex>
                <md-tabs validate-step="true" is-valid="vm.isStepValid" md-dynamic-height md-border-bottom md-selected="vm.activeTab" class="cm-fullheight manage-customer-tabing padding-0">
                    <md-tab ng-repeat="item in vm.tabList" ng-disabled="item.isDisabled || !vm.checkDisable(item.state)" md-on-select="vm.onTabChanges(item)">
                        <md-tab-label>
                            <span class="ms-form-wizard-step-label">
                                <span class="ms-form-wizard-step-text">{{item.title}}<span ng-if="item.state===vm.documentstate">&nbsp;({{vm.documentCount}})</span></span>
                            </span>
                        </md-tab-label>
                        <md-tab-body>
                            <div class="" ui-view="{{item.viewsrc}}"></div>
                        </md-tab-body>
                    </md-tab>
                </md-tabs>
            </ms-form-wizard>
        </md-content>
    </div>
</div>


