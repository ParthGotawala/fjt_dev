
<div id="forms" class="page-layout simple fullwidth doc-page breadcrumb-fixed cm-warehouse-bin-navbar cm-custom-label-common" layout="column" cg-busy="{promise:vm.cgBusyLoading}">
  <div class="header md-accent-bg" layout="row" layout-align="space-between center">

    <div class="white-fg" flex layout="row" layout-align="start start">
      <div>
        <md-button class="goto-rfq-button md-icon-button cm-back-btn-p-m" type="button" aria-label="Go to Customer Packing List" ng-click="vm.goBack()">
          <md-icon md-font-icon="icons-backarrow" class="material-icons icons-backarrow cm-back-btn">
          </md-icon>
          <md-tooltip>Back to Sales Order List</md-tooltip>
        </md-button>
      </div>
      <div layout="row" flex>
        <div layout="column">
          <div>
            <pagetitle is-list="false"
                       is-display-menu-name="true"
                       prefix-content="vm.salesOrderID ? 'Update' : 'Add'"
                       suffix-content="vm.salesOrderID ? ('#: ' + vm.soNumber) : ''"
                       prefix-page-title="vm.soNumber ? vm.soNumber: ''"></pagetitle>
            <md-tooltip md-direction="right" ng-if="vm.soNumber">{{vm.soNumber}}</md-tooltip>
          </div>
          <div layout="row" layout-align="start center">
            <breadcrumbs></breadcrumbs>
          </div>
        </div>
        <div layout="column" flex="40" ng-if="vm.autoCompleteSalesOrder" class="margin-left-20 cm-header-search-add-container">
          <div>
            <md-input-container ng-if="vm.autoCompleteSalesOrder" class="width-100p autocompletecustom margin-0 widget-dashboard-search-area" flex="100" flex-gt-xs="100">
              <custom-auto-complete-search 
                                           on-search-fn="vm.autoCompleteSalesOrder.onSearchFn"
                                           column-name="vm.autoCompleteSalesOrder.columnName"
                                           key-column-name="vm.autoCompleteSalesOrder.keyColumnName"
                                           input-name="vm.autoCompleteSalesOrder.inputName"
                                           placeholder-name="vm.autoCompleteSalesOrder.placeholderName"
                                           key-column-id="vm.autoCompleteSalesOrder.keyColumnId"
                                           is-required="vm.autoCompleteSalesOrder.isRequired"
                                           is-addnew="vm.autoCompleteSalesOrder.isAddnew"
                                           callback-fn="vm.autoCompleteSalesOrder.callbackFn"
                                           on-select-callback-fn="vm.autoCompleteSalesOrder.onSelectCallbackFn">
            </md-input-container>
          </div>
          <div class="cm-square-icon-btn pt-2">
            <md-button class="md-icon-button mv-0-imp margin-right-5-imp md-primary md-raised" ng-if="vm.salesOrderID" ng-click="vm.addSalesorder(false)">
              <md-icon md-font-icon="t-icons-so add-icon" class="material-icons"></md-icon>
              <md-tooltip>Add Sales Order In New Tab</md-tooltip>
            </md-button>
            <md-button class="md-icon-button mv-0-imp margin-right-5-imp md-primary md-raised" ng-if="vm.salesOrderID" ng-click="vm.addSalesorder(true)">
              <md-icon md-font-icon="t-icons-so add-icon same-tab-icon" class="material-icons"></md-icon>
              <md-tooltip>Add Sales Order</md-tooltip>
            </md-button>
          </div>
        </div>
      </div>
    </div>
    <div layout="row" flex>
      <div layout="row" flex="100" layout-wrap>
        <div flex layout="row" layout-wrap>
          <div flex="100" layout-wrap>
            <table cellspacing="0" cellpadding="0" class="cm-header-data-table cm-so-header-data-table">
              <tbody>

                <tr>
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goToSalesOrder();">
                      SO#:
                    </a>
                  </th>
                  <td>
                    <span class="cm-data">
                      <md-tooltip ng-if="vm.soNumber">
                        {{vm.soNumber}}
                      </md-tooltip>
                      <b ng-if="vm.soNumber">{{vm.soNumber}}</b>
                      <b ng-if="!vm.soNumber">-</b>
                    </span>
                    <copy-text ng-if="vm.soNumber" label="'SO#'"
                               text="vm.soNumber"></copy-text>
                  </td>
                  <th>SO Date:</th>
                  <td>
                    <span class="cm-date">
                      <b>{{vm.soDate | date: vm.DefaultDateFormat}}</b>
                    </span>
                  </td>

                </tr>
                <tr>
                  <th>
                    PO#:
                  </th>
                  <td>
                    <span class="cm-data">
                      <md-tooltip ng-if="vm.poNumber">
                        {{vm.poNumber}}
                      </md-tooltip>
                      <b ng-if="vm.poNumber">{{vm.poNumber}}</b>
                      <b ng-if="!vm.poNumber">-</b>
                    </span>
                    <copy-text ng-if="vm.poNumber" label="'PO#'"
                               text="vm.poNumber"></copy-text>
                  </td>
                  
                  <th>PO Date:</th>
                  <td>
                    <span class="cm-date">
                      <b>{{vm.poDate | date: vm.DefaultDateFormat}}</b>
                    </span>
                  </td>
                </tr>
                <tr>
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goTocustomerList();">
                      Customer:
                    </a>
                  </th>
                  <td colspan="3">
                    <span class="cm-name"
                          ng-class="{'text-underline': vm.customerName, 'cursor-pointer': vm.customerName}"
                          ng-click="vm.customerName ? vm.goTocustomerDetail() : ''">
                      <md-tooltip ng-if="vm.customerName">
                        {{vm.customerName}}
                      </md-tooltip>
                      <b>{{vm.customerName?vm.customerName:'-'}}</b>
                    </span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div layout="row" layout-wrap layout-align="start center" class="cm-square-icon-btn">
      <div layout="row" layout-align="center center" ng-if="vm.salesOrderWorkStatus === 2 || vm.salesOrderWorkStatus === -1">
        <span ng-class="{'label-success':vm.salesOrderWorkStatus===2,'label-danger':vm.salesOrderWorkStatus==-1}" class="label-box padding-5-imp margin-10 width-100"><b>{{vm.salesOrderWorkStatusText}}</b></span>
      </div>
      <span class="label-box padding-5-imp width-100" ng-class="vm.getWoStatusClassName(vm.status)"
            ng-if="vm.activeTab!=0">{{vm.getSalesStatus(vm.status)}}</span>
      <div layout="column" class="cm-header-draft-btn" layout-wrap layout-align="center center">
        <md-menu-bar id="user-menu" ng-if="vm.activeTab==0">
          <md-menu md-position-mode="left bottom">
            <md-button class="user-button" ng-click="$mdOpenMenu()" ng-disabled="vm.isDisable || !vm.salesOrderID"
                       aria-label="User settings">
              <div layout="row" layout-align="space-between center">
                <span class="username">{{vm.getSalesStatus(vm.status)}}</span>
                <md-icon md-font-icon="icon-chevron-down"
                         class="icon s16"></md-icon>
              </div>
            </md-button>
            <md-menu-content width="3">
              <md-menu-item ng-repeat="status in vm.WoStatus | orderBy:'DisplayOrder'">
                <md-button ng-click="vm.changeSalesStatus(status.ID,vm.status,$event)">{{status.Name}}</md-button>
              </md-menu-item>
            </md-menu-content>
          </md-menu>
        </md-menu-bar>
        <div layout="row" layout-align="center center" ng-if="vm.activeTab==0">
          <span ng-if="vm.label" class="cm-font-10 padding-bottom-8"><b>{{vm.label}}</b></span>
        </div>
      </div>
      <div layout="row" layout-align="center center" class="cm-btn-group">
        <md-button class="md-icon-button margin-0 md-primary md-raised md-mini margin-left-10" ng-click="vm.printRecord(false)" ng-disabled="vm.frmSalesOrder.$dirty || !vm.salesOrderID || vm.isPrintDisable" ng-if="vm.activeTab!=1">
          <md-icon md-font-icon="icon-printer" class="material-icons"></md-icon>
          <md-tooltip>Print</md-tooltip>
        </md-button>
        <md-button class="md-icon-button margin-0 md-primary md-raised md-mini margin-left-10" ng-click="vm.printRecord(true)" ng-disabled="vm.frmSalesOrder.$dirty || !vm.salesOrderID || vm.isDownloadDisabled" ng-if="vm.activeTab!=1">
          <md-icon md-font-icon="icon-download" class="material-icons"></md-icon>
          <md-tooltip>Download</md-tooltip>
        </md-button>
        <md-button ng-if="vm.activeTab!=1" class="md-icon-button md-primary md-raised margin-left-10" ng-disabled="vm.frmSalesOrder.$dirty || vm.isDuplicateSObtnDisabled || !vm.salesOrderID" ng-click="vm.createDuplicateSO($event)">
          <md-icon md-font-icon="t-icons-duplicate-so" class="material-icons"></md-icon>
          <md-tooltip>Duplicate SO</md-tooltip>
        </md-button>
        <md-button class="md-icon-button md-primary md-raised margin-left-10" ng-click="vm.salesCommissionDetail()" ng-disabled="!vm.salesOrderID" ng-if="vm.activeTab!=1">
          <md-icon md-font-icon="t-icons-sales-commission export-icon" class="material-icons"></md-icon>
          <md-tooltip>Export Sales Commission</md-tooltip>
        </md-button>
        <md-button class="md-primary md-raised"
                   ng-class="{'md-formdirty': vm.frmSalesOrder.$dirty}"
                   id="saveBtn" ng-click="vm.saveSalesOrder(true,$event);"
                   ng-if="vm.activeTab!=1">
          Save
        </md-button>
      </div>
    </div>
  </div>

  <div class="content-card padding-top-side" layout="row" flex="100">
    <md-content flex="100" layout="column">
      <ms-form-wizard flex>
        <md-tabs validate-step="true" is-valid="vm.isStepValid" md-dynamic-height md-border-bottom md-selected="vm.activeTab" class="cm-fullheight manage-customer-tabing padding-0">
          <md-tab ng-repeat="item in vm.tabList" ng-disabled="!vm.checkDisable(item.state)" md-on-select="vm.onTabChanges(item)">
            <md-tab-label>
              <span class="ms-form-wizard-step-label">
                <span class="ms-form-wizard-step-text">{{item.title}}<span ng-if="item.state===vm.documentstate">&nbsp;({{vm.documentCount}})</span></span>
              </span>
            </md-tab-label>
            <md-tab-body>
              <div class="" ui-view="{{item.viewsrc}}"></div>
            </md-tab-body>
          </md-tab>
        </md-tabs>
      </ms-form-wizard>
    </md-content>
  </div>
</div>


