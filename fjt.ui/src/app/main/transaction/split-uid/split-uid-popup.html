<md-dialog aria-label="SplitUID" class="cm-custom-label-common" cg-busy="{promise:vm.cgBusyLoading}" draggable flex="80">
  <form name="vm.splitUIDForm" class="md-inline-form" novalidate>
    <md-toolbar>
      <div class="md-toolbar-tools">
        <h2>Split UMID</h2>
        <span flex></span>
        <popup-header-label label-data="vm.headerData"></popup-header-label>
        <md-button class="md-icon-button" ng-click="vm.cancel()">
          <md-icon role="img" md-font-icon="icon-close" class="material-icons mat-icon icon-close"></md-icon>
        </md-button>
      </div>
    </md-toolbar>

    <md-dialog-content class="padding-10">
      <md-content layout="column">
        <div layout="row" layout-wrap>
          <div flex="50" layout="row" class="pr-5">
            <div class="cm-section-main margin-bottom-5" flex>
              <div class="cm-section-header" flex="100">
                <h2>From</h2>
              </div>
              <div class="cm-section-inner">
                <table cellspacing="0" cellpadding="0" class="cm-table-input-main">
                  <tbody>
                    <tr>
                      <th><p class="label-container">From UMID<span ng-if="!vm.isEdit">&nbsp;*</span><scan-or-enter ng-if="!vm.isEdit"></scan-or-enter></p></th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="text" name="uid" capitalize ng-model="vm.modelSplitUID.uid" ng-keypress="vm.scanUID($event);" id="uid" ng-disabled="vm.isUIDDisable" required ng-maxlength="vm.UMID_MAX_LENGTH">
                          <span flex="100" class="font-size-10" md-autofocus>
                            <b>{{vm.LabelConstant.ScanOREnter.ScanUMID}}</b>
                          </span>
                          <div ng-messages="vm.splitUIDForm.uid.$touched && vm.splitUIDForm.uid.$error" role="alert">
                            <div ng-message="required">
                              <span>{{vm.CORE_MESSAGE_CONSTANT.REQUIRED}}</span>
                            </div>
                            <div ng-message="maxlength">
                              <span>{{vm.getMaxLengthValidation(vm.UMID_MAX_LENGTH,vm.splitUIDForm.uid.$viewValue.length)}}</span>
                            </div>
                          </div>
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th><p class="label-container">Current Count</p></th>
                      <td class="text-right">
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="number" name="pkgQty" ng-model="vm.modelSplitUID.pkgQty" ng-disabled="true">
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th><p class="label-container">Current Units</p></th>
                      <td class="text-right">
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="number" name="pkgUnit" ng-model="vm.modelSplitUID.pkgUnit" ng-disabled="true">
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th>
                        <p class="label-container">
                          <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToUOMList();">Current UOM</a>
                        </p>
                      </th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="text" name="uomName" ng-model="vm.modelSplitUID.uomName" ng-disabled="true">
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th>
                        <p class="label-container">
                          <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToBinList();">Current {{vm.LabelConstant.TransferStock.Bin}}</a>
                        </p>
                      </th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="text" name="binName" ng-model="vm.modelSplitUID.binName" ng-disabled="true">
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th>
                        <p class="label-container">
                          <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToWHList();">Current {{vm.LabelConstant.TransferStock.WH}}</a>
                        </p>
                      </th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="text" name="warehouseName" ng-model="vm.modelSplitUID.warehouseName" ng-disabled="true">
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th>
                        <p class="label-container">
                          <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToWHList();">Current {{vm.LabelConstant.TransferStock.ParentWH}}</a>
                        </p>
                      </th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="text" name="deptName" ng-model="vm.modelSplitUID.deptName" ng-disabled="true">
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th>
                        <p class="label-container">
                          <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToPackaging();">Packaging</a>
                        </p>
                      </th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="text" name="deptName" ng-model="vm.modelSplitUID.packaging" ng-disabled="true">
                        </md-input-container>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <div flex="50" layout="row" class="pr-5">
            <div class="cm-section-main margin-bottom-5" flex>
              <div class="cm-section-header" flex="100">
                <h2>Split Into</h2>
              </div>
              <div class="cm-section-inner">
                <table cellspacing="0" cellpadding="0" class="cm-table-input-main">
                  <tbody>
                    <tr><th></th></tr>
                    <tr>
                      <th><p class="label-container">Enter Count to Split <span ng-if="vm.isUIDDisable">&nbsp;*</span></p></th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="number" id="splitPkgQty" name="splitPkgQty" ng-model="vm.modelSplitUID.splitPkgQty" placeholder="Split Count" onkeypress="return OnlyNumbersWithDot(event)"
                                 maxlength="19" step="{{$root.unitInputStep}}" ng-change="vm.changeSplitQty()" required ng-disabled="!vm.isUIDDisable">
                          <div ng-messages="vm.splitUIDForm.splitPkgQty.$error" ng-if="vm.splitUIDForm.splitPkgQty.$touched" role="alert">
                            <div ng-message="required">
                              <span>{{vm.CORE_MESSAGE_CONSTANT.REQUIRED}}</span>
                            </div>
                            <div ng-message="number || step || maxlength || decimalNumber">
                              <span>{{vm.CORE_MESSAGE_CONSTANT.INVALID}}</span>
                            </div>
                            <div ng-message="maxNumber">
                              <span>{{vm.stringFormat(vm.CORE_MESSAGE_CONSTANT.SPLIT_STOCK_LESS_THAN_CURRENT_COUNTED_STOCK,'Count')}}</span>
                            </div>
                            <div ng-message="minNumber">
                              <span>{{vm.stringFormat(vm.CORE_MESSAGE_CONSTANT.SPLIT_STOCK_NOT_ALLOWED_ZERO,'Count')}}</span>
                            </div>
                          </div>
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th><p class="label-container">Enter Units to Split<span ng-if="vm.isUIDDisable">&nbsp;*</span></p></th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="number" id="splitPkgUnit" name="splitPkgUnit" ng-model="vm.modelSplitUID.splitPkgUnit" placeholder="Split Unit" onkeypress="return OnlyNumbersWithDot(event)"
                                 maxlength="19" step="{{$root.unitInputStep}}" ng-change="vm.changeSplitUnit()" required ng-disabled="!vm.isUIDDisable">
                          <div ng-messages="vm.splitUIDForm.splitPkgUnit.$error" ng-if="vm.splitUIDForm.splitPkgUnit.$touched" role="alert">
                            <div ng-message="required">
                              <span>{{vm.CORE_MESSAGE_CONSTANT.REQUIRED}}</span>
                            </div>
                            <div ng-message="number || step|| maxlength || decimalNumber">
                              <span>{{vm.CORE_MESSAGE_CONSTANT.INVALID}}</span>
                            </div>
                            <div ng-message="maxNumber">
                              <span>{{vm.stringFormat(vm.CORE_MESSAGE_CONSTANT.SPLIT_STOCK_LESS_THAN_CURRENT_COUNTED_STOCK,'Units')}}</span>
                            </div>
                            <div ng-message="minNumber">
                              <span>{{vm.stringFormat(vm.CORE_MESSAGE_CONSTANT.SPLIT_STOCK_NOT_ALLOWED_ZERO,'Units')}}</span>
                            </div>
                          </div>
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th>
                        <p class="label-container">
                          <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToUOMList();">UOM</a>
                        </p>
                      </th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="text" name="uomName" ng-model="vm.modelSplitUID.uomName" ng-disabled="true">
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th>
                        <p class="label-container">
                          <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToBinList();">To {{vm.LabelConstant.TransferStock.Bin}}</a><span ng-if="vm.isUIDDisable">&nbsp;*</span><scan-or-enter></scan-or-enter>
                        </p>
                      </th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0" md-no-float>
                          <input type="text" name="splitBinName" id="splitBinName" capitalize
                                 ng-model="vm.modelSplitUID.splitBinName" ng-disabled="!vm.isUIDDisable"
                                 ng-required="true" maxlength="50" ng-keypress="vm.scanBin($event)" />
                          <span flex="100" class="font-size-10">
                            <b>{{vm.LabelConstant.ScanOREnter.ScanBin}}</b>
                          </span>
                          <div ng-messages="vm.splitUIDForm.splitBinName.$touched && vm.splitUIDForm.splitBinName.$error"
                               role="alert">
                            <div ng-message="required">
                              <span>{{vm.CORE_MESSAGE_CONSTANT.REQUIRED}}</span>
                            </div>
                            <div ng-message="maxlength">
                              <span>{{vm.getMaxLengthValidation(50,vm.splitUIDForm.splitBinName.$viewValue.length)}}</span>
                            </div>
                          </div>
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th>
                        <p class="label-container">
                          <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToWHList();">To {{vm.LabelConstant.TransferStock.WH}}</a>
                        </p>
                      </th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="text" name="splitWarehouseName" ng-model="vm.modelSplitUID.splitWarehouseName" ng-disabled="true">
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th>
                        <p class="label-container">
                          <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToWHList();">To {{vm.LabelConstant.TransferStock.ParentWH}}</a>
                        </p>
                      </th>
                      <td>
                        <md-input-container flex="100" class="margin-bottom-0">
                          <input type="text" name="splitDeptName" ng-model="vm.modelSplitUID.splitDeptName" ng-disabled="true">
                        </md-input-container>
                      </td>
                    </tr>
                    <tr>
                      <th>
                        <p class="label-container">
                          <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToPackaging();">{{vm.autoPackaging.placeholderName}}</a><span ng-if="vm.isUIDDisable">&nbsp;*</span>
                        </p>
                      </th>
                      <td>
                        <md-input-container flex="100" ng-if="vm.autoPackaging" class="autocompletecustom min-width-initial margin-bottom-0" custom-auto-focus="{{vm.focusPackaginAuto}}">
                          <custom-auto-complete datalist="vm.packagingList"
                                                column-name="vm.autoPackaging.columnName"
                                                controller-name="vm.autoPackaging.controllerName"
                                                view-template-url="vm.autoPackaging.viewTemplateURL"
                                                key-column-name="vm.autoPackaging.keyColumnName"
                                                input-name="vm.autoPackaging.inputName"
                                                placeholder-name="vm.autoPackaging.placeholderName"
                                                key-column-id="vm.autoPackaging.keyColumnId"
                                                is-required="vm.autoPackaging.isRequired"
                                                is-addnew="vm.autoPackaging.isAddnew"
                                                add-data="vm.autoPackaging.addData"
                                                callback-fn="vm.autoPackaging.callbackFn"
                                                on-select-callback-fn="vm.autoPackaging.onSelectCallbackFn"
                                                is-disabled="!vm.isUIDDisable">
                          </custom-auto-complete>
                        </md-input-container>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
        <!-- UMID DETAIL BLOCK -->
        <div flex layout="row" ng-if="vm.isUIDDisable">
          <div class="cm-section-main margin-bottom-5" flex="100">
            <div class="cm-section-header" flex="100">
              <div flex="100" layout="row" layout-align="start center" class="notification-condition">
                <div>
                  <span class="border pl-5 pv-3 pr-5" ng-if="vm.modelSplitUID.uid">
                    <b>UMID: {{vm.modelSplitUID.uid}}</b>
                  </span>
                </div>
                <h2 class="margin-left-auto-imp"><span>Initial Count: {{vm.modelSplitUID.uomClassID === vm.MEASUREMENT_TYPES_COUNT.ID ? (vm.modelSplitUID.orgQty) : (vm.modelSplitUID.orgQty |unit)}} | Units: {{ vm.modelSplitUID.uomClassID === vm.MEASUREMENT_TYPES_COUNT.ID ? (vm.modelSplitUID.orgPkgUnit) : (vm.modelSplitUID.orgPkgUnit |unit)}}</span></h2>
              </div>
            </div>
            <div class="cm-section-inner" layout layout-wrap>
              <table cellspacing="0" cellpadding="0" class="cm-table-input-main">
                <tbody>
                  <tr>
                    <td rowspan="3" class="w-70">
                      <img ng-if="vm.modelSplitUID.imageURL" ng-src="{{vm.modelSplitUID.imageURL}}" />
                    </td>
                    <th>
                      <p class="label-container font-size-15-imp">
                        <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToManufacturerList();">{{vm.LabelConstant.MFG.MFG}}</a>
                      </p>
                    </th>
                    <td class="cm-count-material-font padding-top-4">
                      <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToManufacturer();"><span class="cm-count-material-value">{{vm.modelSplitUID.mfg}}</span></a>
                    </td>
                    <th>
                      <p class="label-container font-size-15-imp">
                        <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToMountingTypeList();">Mounting Type</a>
                      </p>
                    </th>
                    <td class="cm-count-material-font padding-top-4 w-300">
                      <span class="cm-count-material-value">{{vm.modelSplitUID.mountingType}}</span>
                    </td>
                    <th>
                      <p class="label-container font-size-15-imp">
                        <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToPackageCaseTypeList();">Package/Case(Shape) Type</a>
                      </p>
                    </th>
                    <td class="cm-count-material-font padding-top-4 w-300">
                      <span class="cm-count-material-value">{{vm.modelSplitUID.partPackage}}</span>
                    </td>
                  </tr>
                  <tr>
                    <th>
                      <p class="label-container font-size-15-imp">
                        <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToPartList();">{{vm.LabelConstant.MFG.MFGPN}}</a>
                      </p>
                    </th>
                    <td class="cm-count-material-font padding-top-4">
                      <a tabindex="-1" class="cm-text-decoration underline" ng-click="vm.goToComponentDetailTab();"> <span class="cm-count-material-value">{{vm.modelSplitUID.mfgPN}}</span></a>
                    </td>
                    <td rowspan="2" colspan="4" class="padding-bottom-0 pl-5 vertical-bottom-align">
                      <div class="cm-section-main current-stock-material-table" flex="100">
                        <div class="cm-section-inner padding-0">
                          <table cellspacing="0" cellpadding="0" class="cm-table-input-main">
                            <tbody>
                              <tr class="cm-count-material-header-bg">
                                <th></th>
                                <th class="text-center">SPQ</th>
                                <th class="text-center">Count</th>
                                <th class="text-center">Units</th>
                                <th class="text-center"><a class="cm-text-decoration" ng-click="vm.goToUOMList();" tabindex="-1">UOM</a></th>
                              </tr>
                              <tr>
                                <th class="text-center">Last Counted Stock</th>
                                <td class="text-right">{{vm.modelSplitUID.uomClassID === vm.MEASUREMENT_TYPES_COUNT.ID ? (vm.modelSplitUID.spq)  : (vm.modelSplitUID.spq | unit)}}</td>
                                <td class="text-right">{{vm.modelSplitUID.uomClassID === vm.MEASUREMENT_TYPES_COUNT.ID ? (vm.modelSplitUID.pkgQty) : (vm.modelSplitUID.pkgQty | unit)}}</td>
                                <td class="text-right">{{vm.modelSplitUID.uomClassID === vm.MEASUREMENT_TYPES_COUNT.ID ? (vm.modelSplitUID.pkgUnit) : (vm.modelSplitUID.pkgUnit | unit)}}</td>
                                <td class="w-200 input-text-center">
                                  {{vm.modelSplitUID.uomName}}
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <th>
                      <p class="label-container font-size-15-imp">
                        <span class="color-black">{{vm.LabelConstant.MFG.MFGPNDescription}}</span>
                      </p>
                    </th>
                    <td class="cm-count-material-font padding-top-4">
                      <span class="cm-count-material-value">{{vm.modelSplitUID.mfgPNDescription}}</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <!-- / UMID DETAIL BLOCK -->
        <!-- ALLOCATED TO KIT -->
        <div flex="100" ng-if="vm.allocatedToKit.length > 0">
          <div class="cm-section-main margin-bottom-5" flex>
            <div class="cm-section-header" flex="100">
              <div flex="70" layout="row">
                <h2>Allocated To Kit {{vm.CORE_MESSAGE_CONSTANT.SPLIT_MATERIAL_POPUP_NOTE}}</h2>
              </div>
            </div>
            <div class="cm-section-inner">
              <table class="cm-table-input-main table-umid-allocated-kit">
                <thead>
                  <tr>
                    <th>#</th>
                    <th class="w-500">Kit</th>
                    <th>{{vm.LabelConstant.KitAllocation.KitReleaseDate}}</th>
                    <th>{{vm.LabelConstant.KitAllocation.KitReleaseStatus}}</th>
                    <th>{{vm.LabelConstant.KitAllocation.AllocatedCount}}</th>
                    <th>{{vm.LabelConstant.KitAllocation.AllocatedUnits}}</th>
                    <th>{{vm.LabelConstant.KitAllocation.AllocatedUOM}}</th>
                  </tr>
                </thead>
                <tbody>
                  <tr ng-repeat="item in vm.allocatedToKit">
                    <td class="text-center">{{($index+1)}}</td>
                    <td><a ng-click="vm.goToKitList(item)">{{item.kitName}}</a></td>
                    <td class="text-left w-130">{{item.kitReleaseDate | date:vm.dateTimeDisplayFormat}}</td>
                    <td class="text-center w-160">
                      <label class="cursor-pointer label-box mv-0" ng-class="{'label-warning':item.kitReleaseStatus == vm.Kit_Release_Status.NotReleased, 'label-info':item.kitReleaseStatus == vm.Kit_Release_Status.PartiallyReleased ,'label-success' :item.kitReleaseStatus == vm.Kit_Release_Status.FullReleased,'light-green-bg' :item.kitReleaseStatus == vm.Kit_Release_Status.ReadyToRelease }" ng-if="item.kitReleaseStatus">
                        {{item.kitReleaseStatus}}
                      </label>
                    </td>
                    <td class="text-right">{{item.uomClassID === vm.MEASUREMENT_TYPES_COUNT.ID ? item.allocatedQty :  (item.allocatedQty | unit)}}</td>
                    <td class="text-right">{{item.uomClassID === vm.MEASUREMENT_TYPES_COUNT.ID ? item.allocatedUnit : (item.allocatedUnit | unit)}}</td>
                    <td>{{item.allocatedUOM}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <!-- / ALLOCATED TO KIT -->
      </md-content>
    </md-dialog-content>
    <md-dialog-actions layout="row">
      <md-button class="md-default md-raised " ng-click="vm.cancel()">Cancel</md-button>
      <md-button class="md-primary md-raised" ng-click="vm.save()" ng-class="{'md-formdirty': vm.checkFormDirty(vm.splitUIDForm) }" aria-label="Submit">Save</md-button>
    </md-dialog-actions>
  </form>
</md-dialog>
