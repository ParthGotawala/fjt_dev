<div id="forms" class="page-layout simple fullwidth doc-page breadcrumb-fixed cm-warehouse-bin-navbar" layout="column" cg-busy="{promise:vm.cgBusyLoading}">

  <div class="header md-accent-bg" layout="row" layout-align="space-between center" ng-class="{'height-80': !vm.showTab, 'height-60': vm.showTab}">
    <md-button class="goto-products-button md-icon-button cm-back-btn-p-m" type="button" aria-label="Go to Customerlist" ng-click="vm.goBack()" ng-if="!vm.showTab">
      <md-icon md-font-icon="icons-backarrow" class="material-icons icons-backarrow cm-back-btn">
      </md-icon>
    </md-button>

    <div class="white-fg" layout="column" layout-align="start start">
      <div class="h2" layout="row" layout-align="start center">
        <pagetitle is-list="vm.showTab ? true : false"
                   is-display-menu-name="true"
                   prefix-content="vm.showTab ? '' : (vm.receiptID ? 'Update' : 'Add')"
                   suffix-content="vm.invoiceDebitCreditNo ? ': ' + vm.invoiceDebitCreditNo : ''">
        </pagetitle>
        <md-tooltip md-direction="right" ng-if="vm.invoiceDebitCreditNo">{{vm.invoiceDebitCreditNo}}</md-tooltip>
      </div>
      <div layout="row" layout-align="start center">
        <breadcrumbs></breadcrumbs>
      </div>
    </div>
    <div flex="15" class="margin-left-5-imp" ng-if="(vm.autoCompleteInvoiceNumber || vm.autoCompleteCreditMemoNumber || vm.autoCompleteDebitMemoNumber)  && !vm.showTab">

      <div ng-if="vm.supplierInvoiceEditObj.isInvoiceState">
        <md-input-container md-no-float ng-if="vm.autoCompleteInvoiceNumber" class="width-100p autocompletecustom margin-0 widget-dashboard-search-area" flex="100" flex-gt-xs="100">
          <custom-auto-complete-search on-search-fn="vm.autoCompleteInvoiceNumber.onSearchFn"
                                       column-name="vm.autoCompleteInvoiceNumber.columnName"
                                       key-column-name="vm.autoCompleteInvoiceNumber.keyColumnName"
                                       key-column-id="vm.autoCompleteInvoiceNumber.keyColumnId"
                                       input-name="vm.autoCompleteInvoiceNumber.inputName"
                                       placeholder-name="vm.autoCompleteInvoiceNumber.placeholderName"
                                       is-required="vm.autoCompleteInvoiceNumber.isRequired"
                                       is-addnew="vm.autoCompleteInvoiceNumber.isAddnew"
                                       on-select-callback-fn="vm.autoCompleteInvoiceNumber.onSelectCallbackFn"
                                       is-uppercase-search-text="vm.autoCompleteInvoiceNumber.isUppercaseSearchText">
          </custom-auto-complete-search>
        </md-input-container>
      </div>
      <div ng-if="vm.supplierInvoiceEditObj.isInvoiceState" class="cm-square-icon-btn pt-2">
        <md-button class="md-primary md-raised mv-0-imp ml-0 md-icon-button" ng-click="vm.addInvoice(true);" ng-if="!vm.showTab && vm.receiptID">
          <md-icon md-font-icon="t-icons-supplier-invoice" class="add-icon icon"></md-icon>
          <md-tooltip>Add Invoice In New Tab</md-tooltip>
        </md-button>
        <md-button class="md-primary md-raised mv-0-imp ml-0 md-icon-button" ng-click="vm.addInvoice(false);" ng-if="!vm.showTab && vm.receiptID">
          <md-icon md-font-icon="t-icons-supplier-invoice" class="add-icon icon same-tab-icon"></md-icon>
          <md-tooltip>Add Invoice</md-tooltip>
        </md-button>
      </div>

      <div ng-if="vm.supplierInvoiceEditObj.isCreditMemoState">
        <md-input-container md-no-float ng-if="vm.autoCompleteCreditMemoNumber" class="width-100p autocompletecustom margin-0 widget-dashboard-search-area" flex="100" flex-gt-xs="100">
          <custom-auto-complete-search on-search-fn="vm.autoCompleteCreditMemoNumber.onSearchFn"
                                       column-name="vm.autoCompleteCreditMemoNumber.columnName"
                                       key-column-name="vm.autoCompleteCreditMemoNumber.keyColumnName"
                                       key-column-id="vm.autoCompleteCreditMemoNumber.keyColumnId"
                                       input-name="vm.autoCompleteCreditMemoNumber.inputName"
                                       placeholder-name="vm.autoCompleteCreditMemoNumber.placeholderName"
                                       is-required="vm.autoCompleteCreditMemoNumber.isRequired"
                                       is-addnew="vm.autoCompleteCreditMemoNumber.isAddnew"
                                       on-select-callback-fn="vm.autoCompleteCreditMemoNumber.onSelectCallbackFn">

          </custom-auto-complete-search>
        </md-input-container>
      </div>
      <div ng-if="vm.supplierInvoiceEditObj.isCreditMemoState" class="cm-square-icon-btn pt-2">
        <md-button class="md-primary md-raised mv-0-imp ml-0 md-icon-button" ng-click="vm.addCreditMemo(true);" ng-if="!vm.showTab && vm.receiptID">
          <md-icon md-font-icon="t-icons-supplier-credit-memo" class="add-icon icon"></md-icon>
          <md-tooltip>Add Credit Memo In New Tab</md-tooltip>
        </md-button>
        <md-button class="md-primary md-raised mv-0-imp ml-0 md-icon-button" ng-click="vm.addCreditMemo(false);" ng-if="!vm.showTab && vm.receiptID">
          <md-icon md-font-icon="t-icons-supplier-credit-memo" class="add-icon icon same-tab-icon"></md-icon>
          <md-tooltip>Add Credit Memo</md-tooltip>
        </md-button>
      </div>

      <div ng-if="vm.supplierInvoiceEditObj.isDebitMemoState">
        <md-input-container md-no-float ng-if="vm.autoCompleteDebitMemoNumber" class="width-100p autocompletecustom margin-0 widget-dashboard-search-area" flex="100" flex-gt-xs="100">
          <custom-auto-complete-search on-search-fn="vm.autoCompleteDebitMemoNumber.onSearchFn"
                                       column-name="vm.autoCompleteDebitMemoNumber.columnName"
                                       key-column-name="vm.autoCompleteDebitMemoNumber.keyColumnName"
                                       key-column-id="vm.autoCompleteDebitMemoNumber.keyColumnId"
                                       input-name="vm.autoCompleteDebitMemoNumber.inputName"
                                       placeholder-name="vm.autoCompleteDebitMemoNumber.placeholderName"
                                       is-required="vm.autoCompleteDebitMemoNumber.isRequired"
                                       is-addnew="vm.autoCompleteDebitMemoNumber.isAddnew"
                                       on-select-callback-fn="vm.autoCompleteDebitMemoNumber.onSelectCallbackFn">

          </custom-auto-complete-search>
        </md-input-container>
      </div>
      <div ng-if="vm.supplierInvoiceEditObj.isDebitMemoState" class="cm-square-icon-btn pt-2">
        <md-button class="md-primary md-raised mv-0-imp ml-0 md-icon-button" ng-click="vm.addDebitMemo(true);" ng-if="!vm.showTab && vm.receiptID">
          <md-icon md-font-icon="t-icons-supplier-debit-memo" class="add-icon icon"></md-icon>
          <md-tooltip>Add Debit Memo In New Tab</md-tooltip>
        </md-button>
        <md-button class="md-primary md-raised mv-0-imp ml-0 md-icon-button" ng-click="vm.addDebitMemo(false);" ng-if="!vm.showTab && vm.receiptID">
          <md-icon md-font-icon="t-icons-supplier-debit-memo" class="add-icon icon same-tab-icon"></md-icon>
          <md-tooltip>Add Debit Memo</md-tooltip>
        </md-button>
      </div>

    </div>

    <div layout="row" ng-if="vm.supplierInvoiceEditObj && !vm.showTab" flex="nogrow" layout-align="start start">
      <div layout="row" class="cm-workorder-table" layout-wrap flex>
        <div flex layout="row" layout-wrap>
          <div flex="100" layout-wrap>
            <table cellspacing="0" cellpadding="0" class="cm-header-data-table cm-supplier-invoice-header-table">
              <tbody>

                <tr ng-if="!vm.supplierInvoiceEditObj.isShowRMADetail && vm.supplierInvoiceEditObj.isInvoiceState">
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goToPackingSlipList();">
                      Packing Slip#:
                    </a>
                  </th>
                  <td>
                    <span>
                      <md-tooltip ng-if="vm.supplierInvoiceEditObj.packingSlipNumber">{{vm.supplierInvoiceEditObj.packingSlipNumber}}</md-tooltip>
                      <a ng-if="vm.supplierInvoiceEditObj.refPackingSlipId" class="cursor-pointer text-underline cm-data"
                         ng-click="vm.goToPackingSlipDetail();">
                        <b>
                          {{vm.supplierInvoiceEditObj.packingSlipNumber}}
                        </b>
                      </a>
                      <b class="cm-data" ng-if="!vm.supplierInvoiceEditObj.refPackingSlipId">
                        {{vm.supplierInvoiceEditObj.packingSlipNumber}}
                      </b>
                    </span>
                    <copy-text label="vm.LabelConstant.SupplierInvoice.PackingSlipNumber" text="vm.supplierInvoiceEditObj.packingSlipNumber" ng-if="vm.supplierInvoiceEditObj.packingSlipNumber"></copy-text>
                  </td>
                </tr>

                <tr ng-if="!vm.supplierInvoiceEditObj.isShowRMADetail && vm.supplierInvoiceEditObj.isInvoiceState">
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goToSupplierInvoiceList();">
                      Invoice#:
                    </a>
                  </th>
                  <td>
                    <span class="cm-data text-underline cursor-pointer" ng-click="vm.goToSupplierInvoiceDetail(vm.supplierInvoiceEditObj.id)">
                      <md-tooltip ng-if="vm.supplierInvoiceEditObj.invoiceNumber">{{vm.supplierInvoiceEditObj.invoiceNumber}}</md-tooltip>
                      <b>{{vm.supplierInvoiceEditObj.invoiceNumber}}</b>
                    </span>
                    <copy-text label="vm.LabelConstant.SupplierInvoice.InvoiceNumber" text="vm.supplierInvoiceEditObj.invoiceNumber" ng-if="vm.supplierInvoiceEditObj.invoiceNumber"></copy-text>
                  </td>
                </tr>

                <tr ng-if="!vm.supplierInvoiceEditObj.isShowRMADetail && vm.supplierInvoiceEditObj.isCreditMemoState">
                  <th ng-if="vm.supplierInvoiceEditObj.creditMemoType === vm.TRANSACTION.creditMemoType[0].value">
                    <a class="cursor-pointer text-underline" ng-click="vm.goToSupplierInvoiceList();">
                      Invoice#:
                    </a>
                  </th>
                  <td ng-if="vm.supplierInvoiceEditObj.creditMemoType === vm.TRANSACTION.creditMemoType[0].value">
                    <span class="cm-data text-underline cursor-pointer" ng-click="vm.goToSupplierInvoiceDetail(vm.supplierInvoiceEditObj.refInvoiceId)">
                      <md-tooltip>{{vm.supplierInvoiceEditObj.refInvoiceNumber}}</md-tooltip>
                      <b>{{vm.supplierInvoiceEditObj.refInvoiceNumber}}</b>
                    </span>
                    <copy-text label="vm.LabelConstant.SupplierInvoice.InvoiceNumber" text="vm.supplierInvoiceEditObj.refInvoiceNumber" ng-if="vm.supplierInvoiceEditObj.refInvoiceNumber"></copy-text>
                  </td>
                </tr>

                <tr ng-if="!vm.supplierInvoiceEditObj.isShowRMADetail && vm.supplierInvoiceEditObj.isCreditMemoState">
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goToCreditMemoList();">
                      Credit Memo#:
                    </a>
                  </th>
                  <td>
                    <span class="cm-data text-underline cursor-pointer" ng-click="vm.goToCreditMemoDetail()">
                      <md-tooltip ng-if="vm.supplierInvoiceEditObj.creditMemoNumber">{{vm.supplierInvoiceEditObj.creditMemoNumber}}</md-tooltip>
                      <b>{{vm.supplierInvoiceEditObj.creditMemoNumber}}</b>
                    </span>
                    <copy-text label="vm.LabelConstant.SupplierInvoice.CreditMemoNumber" text="vm.supplierInvoiceEditObj.creditMemoNumber" ng-if="vm.supplierInvoiceEditObj.creditMemoNumber"></copy-text>
                  </td>
                </tr>

                <tr ng-if="!vm.supplierInvoiceEditObj.isShowRMADetail && vm.supplierInvoiceEditObj.isDebitMemoState">
                  <th ng-if="vm.supplierInvoiceEditObj.creditMemoType === vm.TRANSACTION.debitMemoType[0].value">
                    <a class="cursor-pointer text-underline" ng-click="vm.goToSupplierInvoiceList();">
                      Invoice#:
                    </a>
                  </th>
                  <td ng-if="vm.supplierInvoiceEditObj.creditMemoType === vm.TRANSACTION.debitMemoType[0].value">
                    <span class="cm-data text-underline cursor-pointer" ng-click="vm.goToSupplierInvoiceDetail(vm.supplierInvoiceEditObj.refInvoiceId)">
                      <md-tooltip>{{vm.supplierInvoiceEditObj.refInvoiceNumber}}</md-tooltip>
                      <b>{{vm.supplierInvoiceEditObj.refInvoiceNumber}}</b>
                    </span>
                    <copy-text label="vm.LabelConstant.SupplierInvoice.InvoiceNumber" text="vm.supplierInvoiceEditObj.refInvoiceNumber" ng-if="vm.supplierInvoiceEditObj.refInvoiceNumber"></copy-text>
                  </td>
                </tr>

                <tr ng-if="!vm.supplierInvoiceEditObj.isShowRMADetail && vm.supplierInvoiceEditObj.isDebitMemoState">
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goToDebitMemoList();">
                      Debit Memo#:
                    </a>
                  </th>
                  <td>
                    <span class="cm-data text-underline cursor-pointer" ng-click="vm.goToDebitMemoDetail()">
                      <md-tooltip>{{vm.supplierInvoiceEditObj.debitMemoNumber}}</md-tooltip>
                      <b>{{vm.supplierInvoiceEditObj.debitMemoNumber}}</b>
                    </span>
                    <copy-text label="vm.LabelConstant.SupplierInvoice.DebitMemoNumber" text="vm.supplierInvoiceEditObj.debitMemoNumber" ng-if="vm.supplierInvoiceEditObj.debitMemoNumber"></copy-text>
                  </td>
                </tr>

                <tr ng-if="vm.supplierInvoiceEditObj.isShowRMADetail">
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goToPurchaseOrderList();">
                      PO#
                    </a> / <a class="cursor-pointer text-underline padding-left-0-imp" ng-click="vm.goToSupplierRMAList();">
                      {{vm.LabelConstant.SupplierRMA.RMANumber}}:
                    </a>
                  </th>
                  <td>
                    <span class="cm-data text-underline cursor-pointer" ng-click="vm.goToSupplierRMADetail()">
                      <md-tooltip ng-if="vm.supplierInvoiceEditObj.poNumber">{{vm.supplierInvoiceEditObj.poNumber}}</md-tooltip>
                      <b>{{vm.supplierInvoiceEditObj.poNumber}}</b>
                    </span>
                    <copy-text label="vm.LabelConstant.SupplierRMA.RMANumber" text="vm.supplierInvoiceEditObj.poNumber" ng-if="vm.supplierInvoiceEditObj.poNumber"></copy-text>
                  </td>
                </tr>

                <tr ng-if="vm.supplierInvoiceEditObj.isShowRMADetail">
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goToCreditMemoList();">
                      Credit Memo#:
                    </a>
                  </th>
                  <td>
                    <span class="cm-data text-underline cursor-pointer" ng-click="vm.goToCreditMemoDetail()">
                      <md-tooltip ng-if="vm.supplierInvoiceEditObj.creditMemoNumber">{{vm.supplierInvoiceEditObj.creditMemoNumber}}</md-tooltip>
                      <b>{{vm.supplierInvoiceEditObj.creditMemoNumber}}</b>
                    </span>
                    <copy-text label="vm.LabelConstant.SupplierInvoice.CreditMemoNumber" text="vm.supplierInvoiceEditObj.creditMemoNumber" ng-if="vm.supplierInvoiceEditObj.creditMemoNumber"></copy-text>
                  </td>
                </tr>

                <tr>
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goToSupplierList();">
                      Supplier:
                    </a>
                  </th>
                  <td>
                    <span class="cm-data" ng-class="{'text-underline': vm.supplierInvoiceEditObj.mfgFullName, 'cursor-pointer': vm.supplierInvoiceEditObj.mfgFullName}" ng-click="vm.supplierInvoiceEditObj.mfgCodeID ? vm.goToSupplierDetail() : ''">
                      <md-tooltip ng-if="vm.supplierInvoiceEditObj.mfgFullName && vm.supplierInvoiceEditObj.mfgCodeID" class="cm-white-space-normal max-width-420 p-5 cm-height-auto">{{vm.supplierInvoiceEditObj.mfgFullName}}</md-tooltip>
                      <b>{{vm.supplierInvoiceEditObj.mfgFullName}}</b>
                    </span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div layout="row" ng-if="vm.supplierInvoiceEditObj.isInvoiceState && !vm.showTab" flex="nogrow" layout-align="start start">
      <div layout="row" class="cm-workorder-table" layout-wrap flex>
        <div flex layout="row" layout-wrap>
          <div flex="100" layout-wrap>
            <table cellspacing="0" cellpadding="0" class="cm-header-data-table cm-supplier-invoice-header-table">
              <tbody>

                <tr>
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goToPurchaseOrderList();">
                      {{vm.LabelConstant.Purchase.PO}}:
                    </a>
                  </th>
                  <td>
                    <span>
                      <md-tooltip ng-if="vm.supplierInvoiceEditObj.poNumber">{{vm.supplierInvoiceEditObj.poNumber}}</md-tooltip>
                      <a ng-if="vm.supplierInvoiceEditObj.refPurchaseOrderID" class="cursor-pointer text-underline cm-data"
                         ng-click="vm.goToPurchaseOrderDetail();">
                        <b>
                          {{vm.supplierInvoiceEditObj.poNumber}}
                        </b>
                      </a>
                      <b class="cm-data" ng-if="!vm.supplierInvoiceEditObj.refPurchaseOrderID">
                        {{vm.supplierInvoiceEditObj.poNumber}}
                      </b>
                    </span>
                    <copy-text label="vm.LabelConstant.Purchase.PO" text="vm.supplierInvoiceEditObj.poNumber" ng-if="vm.supplierInvoiceEditObj.poNumber"></copy-text>
                  </td>
                </tr>

                <tr>
                  <th>
                    <a class="cursor-pointer text-underline" ng-click="vm.goToSalesOrderList();">
                      {{vm.LabelConstant.Purchase.SO}}:
                    </a>
                  </th>
                  <td>
                    <span class="cm-data">
                      <md-tooltip ng-if="vm.supplierInvoiceEditObj.supplierSONumber">{{vm.supplierInvoiceEditObj.supplierSONumber}}</md-tooltip>
                      <b>{{vm.supplierInvoiceEditObj.supplierSONumber}}</b>
                    </span>
                    <copy-text label="vm.LabelConstant.Purchase.SO" text="vm.supplierInvoiceEditObj.supplierSONumber" ng-if="vm.supplierInvoiceEditObj.supplierSONumber"></copy-text>
                  </td>
                </tr>
                <tr>
                  <th>
                  </th>
                  <td>
                    <span class="cm-data">
                    </span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div flex layout="row" layout-align="end center">
      <div layout="row" flex layout-align="end start" class="cm-square-icon-btn cm-btn-group"
            ng-class="{'pb-5': vm.supplierInvoiceEditObj.lockStatus!==vm.TRANSACTION.CustomerPaymentLockStatus.Locked}">
        <div layout="column" layout-align="center center">
          <div layout="row" layout-align="end-center" class="margin-right-10">
            <div layout="column" ng-if="vm.showInvoiceApprovalStatusText && vm.showInvoiceApprovalStatus">
              <span class="label-box" ng-class="{'label-success': vm.showInvoiceApprovalStatus === vm.invoiceApprovalStatusOptionsGridHeaderDropdown[1].code, 'label-warning': vm.showInvoiceApprovalStatus === vm.invoiceApprovalStatusOptionsGridHeaderDropdown[2].code, 'label-primary': vm.showInvoiceApprovalStatus === vm.invoiceApprovalStatusOptionsGridHeaderDropdown[3].code }">
                <md-tooltip ng-if="vm.showInvoiceApprovalStatusText">{{vm.core.FEATURE_NAME.SupplierInvoiceApproval}} Status</md-tooltip>
                {{vm.showInvoiceApprovalStatusText}}
              </span>
              <div layout="column" layout-align="center center" flex="100">
                <span class="font-weight-600 font-size-10">
                  SINV Approval Status
                </span>
              </div>
            </div>
          </div>
          <div layout="row" layout-align="end-center" class="margin-right-10 mt-1"
               ng-if="vm.supplierInvoiceEditObj.lockStatus===vm.TRANSACTION.CustomerPaymentLockStatus.Locked">
            <span class="label-box label-danger">
              Locked
              <md-tooltip md-direction="bottom" class="tt-multiline">
                Locked By: {{vm.supplierInvoiceEditObj.lockedByUser}} <br />
                Locked Date: {{vm.supplierInvoiceEditObj.lockedAt}}
              </md-tooltip>
            </span>
          </div>
        </div>
      </div>
      <div layout="row" layout-align="end start" class="cm-square-icon-btn cm-btn-group">
        <div layout="column" layout-align="center center">
          <div layout="row" layout-align="end-center">
            <div layout="column" ng-if="vm.showInvoiceStatusText">
              <span class="label-box"
                    ng-class="{'label-success': vm.showInvoiceStatus == vm.PackingSlipStatus.Approved,
                  'label-danger': vm.showInvoiceStatus == vm.PackingSlipStatus.Investigate,
                  'bg-purple': vm.showInvoiceStatus == vm.PackingSlipStatus.PartiallyPaid,
                  'label-primary': vm.showInvoiceStatus == vm.PackingSlipStatus.Paid,
                    'bg-brown': vm.showInvoiceStatus == vm.PackingSlipStatus.PendingManagementApproval,
                  'label-warning': vm.showInvoiceStatus == vm.PackingSlipStatus.Pending }">
                {{vm.showInvoiceStatusText}}
              </span>
              <div layout="column" layout-align="center center" flex="100">
                <span class="font-weight-600 font-size-10">
                  {{vm.supplierInvoiceEditObj.isInvoiceState ? 'SINV Status' : (vm.supplierInvoiceEditObj.isCreditMemoState? 'SCM Status' : (vm.supplierInvoiceEditObj.isDebitMemoState ? 'SDM Status' : ''))}}
                </span>
              </div>
            </div>
          </div>
          <div layout="row" layout-align="end-center" class="mt-5"
               ng-if="vm.supplierInvoiceEditObj && (vm.supplierInvoiceEditObj.isCreditMemoState || vm.supplierInvoiceEditObj.isDebitMemoState) && vm.supplierInvoiceEditObj.markedForRefund === true">
            <span class="label-box label-success" ng-if="vm.supplierInvoiceEditObj.totalRefundedAmount === vm.supplierInvoiceEditObj.markedForRefundAmt">
              Fully Refunded
              <md-tooltip>Refund Status</md-tooltip>
            </span>
            <span class="label-box label-success"
                  ng-if="vm.supplierInvoiceEditObj.totalRefundedAmount && vm.supplierInvoiceEditObj.totalRefundedAmount !== vm.supplierInvoiceEditObj.markedForRefundAmt">
              Partially Refunded
              <md-tooltip>Refund Status</md-tooltip>
            </span>
            <span class="label-box label-success"
                  ng-if="(!vm.supplierInvoiceEditObj.totalRefundedAmount)">
              Waiting for Refund
              <md-tooltip>Refund Status</md-tooltip>
            </span>
          </div>
        </div>
        <div ng-if="vm.showTab &&  (vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_TARIFF_STATE)"
             ng-class="{'pb-15': (!vm.allowSupplierInvoiceApproval && (vm.showTab && vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_TARIFF_STATE) || (!vm.supplierInvoiceEditObj.isShowRMADetail && vm.supplierInvoiceEditObj.isInvoiceState))}">
          <md-button class="md-primary md-raised mr-0" ng-click="vm.showCurrentBalanceAndPastDue($event);">
            Current Balance & Past Due
          </md-button>
        </div>
        <div ng-if="!vm.showTab && vm.receiptID && vm.supplierInvoiceEditObj.id"
             ng-class="{'pb-15': (!vm.allowSupplierInvoiceApproval || (!vm.showTab && vm.receiptID && vm.supplierInvoiceEditObj.id))}">
          <md-button class="md-primary md-raised mr-0" type="button" ng-click="vm.haltResumeSalesOrder(vm.supplierInvoiceEditObj,$event)">
            {{vm.supplierInvoiceEditObj.haltStatus===vm.HaltResumePopUp.HaltStatus?'Resume':'Halt'}} {{vm.supplierInvoiceEditObj.isInvoiceState?'Invoice':(vm.supplierInvoiceEditObj.isCreditMemoState?'Credit Memo':(vm.supplierInvoiceEditObj.isDebitMemoState?'Debit Memo':''))}}
          </md-button>
        </div>
        <div ng-if="(vm.showTab && vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_TARIFF_STATE) || (!vm.supplierInvoiceEditObj.isShowRMADetail && vm.supplierInvoiceEditObj.isInvoiceState)">
          <md-button class="md-primary md-raised cm-feture-btn-color" ng-click="vm.approveInvoice($event);"
                     ng-disabled="!vm.allowSupplierInvoiceApproval ||
                   (!vm.supplierInvoiceEditObj.isShowRMADetail && vm.supplierInvoiceEditObj.isInvoiceState &&
                   vm.showInvoiceApprovalStatus !== vm.invoiceApprovalStatusOptionsGridHeaderDropdown[2].code) ||
                   (vm.supplierInvoiceForm.$dirty || vm.miscForm.$dirty)">
            Approve Invoice
          </md-button>
          <div layout="row" layout-align="center center" flex="100">
            <span class="font-weight-600 font-size-10" ng-if="!vm.allowSupplierInvoiceApproval">
              Enable feature to use.
            </span>
          </div>
        </div>
        <div ng-if="vm.showTab &&  (vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_PAYMENT_STATE)">
          <md-button class="md-primary md-raised cm-feture-btn-color margin-right-8imp" ng-click="vm.voidAndReIssuePayment($event);"
                     ng-disabled="!vm.allowToVoidAndReIssuePaymentFeature">
            Void & Reissue Payment
          </md-button>
          <div layout="row" layout-align="center center" flex="100">
            <span class="font-weight-600 font-size-10" ng-if="!vm.allowToVoidAndReIssuePaymentFeature">
              Enable feature to use.
            </span>
          </div>
        </div>
        <div ng-if="vm.showTab &&  (vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_TARIFF_STATE)"
             ng-class="{'pb-15': (!vm.allowSupplierInvoiceApproval && (vm.showTab && vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_TARIFF_STATE) || (!vm.supplierInvoiceEditObj.isShowRMADetail && vm.supplierInvoiceEditObj.isInvoiceState))}">
          <md-button class="md-primary md-raised" ng-click="vm.payNowForInvoice();">
            Pay Now
          </md-button>
        </div>
        <md-button class="md-icon-button md-primary md-raised md-minipb-15" ng-click="vm.showPaymentTransactions(vm.supplierInvoiceEditObj,$event)" ng-if="!vm.showTab && vm.receiptID">
          <md-icon md-font-icon="icons-supplier-payment-history" class="material-icons"></md-icon>
          <md-tooltip>Payment History</md-tooltip>
        </md-button>
        <md-button class="md-icon-button md-primary md-raised md-mini" ng-click="vm.opencustomerpackingSlipChangesHistoryAuditLog($event)" ng-if="!vm.showTab && vm.receiptID">
          <md-icon md-font-icon="t-icons-history-text" class="material-icons"></md-icon>
          <md-tooltip>{{vm.supplierInvoiceEditObj.isInvoiceState?'Invoice':(vm.supplierInvoiceEditObj.isCreditMemoState?'Credit Memo':'Debit Memo')}} History</md-tooltip>
        </md-button>
        <md-button class="md-icon-button md-primary md-raised md-mini" ng-click="vm.printDebitMemoReport();" ng-if="!vm.showTab &&  (vm.currentState === vm.TRANSACTION.TRANSACTION_MANAGE_DEBIT_INVOICE_STATE) && vm.receiptID" ng-disabled="vm.isPrintDisable || vm.supplierInvoiceForm.$dirty">
          <md-icon md-font-icon="icon-printer" class="material-icons"></md-icon>
          <md-tooltip>Print</md-tooltip>
        </md-button>
        <md-button class="md-icon-button md-primary md-raised md-mini" ng-click="vm.printDebitMemoReport(true);" ng-if="!vm.showTab &&  (vm.currentState === vm.TRANSACTION.TRANSACTION_MANAGE_DEBIT_INVOICE_STATE) && vm.receiptID" ng-disabled="vm.isDownloadDisabled || vm.supplierInvoiceForm.$dirty">
          <md-icon md-font-icon="icon-download" class="material-icons"></md-icon>
          <md-tooltip>Download</md-tooltip>
        </md-button>
        <md-button class="md-icon-button md-primary md-raised md-mini" ng-click="vm.addRefund(true);"
                   ng-if="!vm.showTab && vm.receiptID &&  (vm.currentState === vm.TRANSACTION.TRANSACTION_MANAGE_DEBIT_INVOICE_STATE || vm.currentState === vm.TRANSACTION.TRANSACTION_MANAGE_CREDIT_INVOICE_STATE)"
                   ng-disabled="vm.supplierInvoiceEditObj.totalRefundedAmount === vm.supplierInvoiceEditObj.markedForRefundAmt || !vm.supplierInvoiceEditObj.markedForRefund || vm.supplierInvoiceForm.$dirty">
          <md-icon md-font-icon="icons-add-supplier-refund" class="material-icons"></md-icon>
          <md-tooltip>Add Refund</md-tooltip>
        </md-button>
        <md-button class="md-primary md-raised md-mini"
                   ng-class="{'md-formdirty': vm.supplierInvoiceForm.$dirty || vm.miscForm.$dirty }"
                   ng-disabled="vm.saveBtnDisableFlag || (vm.supplierInvoiceEditObj.lockStatus===vm.TRANSACTION.CustomerPaymentLockStatus.Locked && !vm.loginUser.isUserSuperAdmin)"
                   id='saveBtn' ng-click="vm.saveInvoice();" ng-if="!vm.showTab && vm.showSaveBtn">
          Save
        </md-button>
        <md-button class="md-primary md-raised margin-right-8imp" ng-click="vm.addPackingSlip();" ng-if="vm.showTab && (vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_PACKING_SLIP_STATE)">
          Add Packing Slip
        </md-button>
        <div ng-if="vm.showTab"
             ng-class="{'pb-15': (!vm.allowToVoidAndReIssuePaymentFeature && (vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_PAYMENT_STATE)),
             'pb-15': (!vm.allowSupplierInvoiceApproval && (vm.showTab && vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_TARIFF_STATE) || (!vm.supplierInvoiceEditObj.isShowRMADetail && vm.supplierInvoiceEditObj.isInvoiceState))}">
          <md-button class="md-primary md-raised ml-0" ng-click="vm.addInvoice(true);">
            Add Invoice
          </md-button>
        </div>
        <md-button class="md-primary md-raised ml-0" ng-click="vm.addSupplierRMA();" ng-if="vm.showTab && (vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_RMA_STATE)">
          Add Supplier RMA OR RMA Packing Slip
        </md-button>
        <md-button class="md-primary md-raised ml-0" ng-click="vm.addCreditMemo(true);" ng-if="vm.showTab && (vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_CREDIT_MEMO_STATE)">
          Add Credit Memo
        </md-button>
        <md-button class="md-primary md-raised ml-0" ng-click="vm.addDebitMemo(true);" ng-if="vm.showTab && (vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_DEBIT_MEMO_STATE)">
          Add Debit Memo
        </md-button>
        <md-button class="md-primary md-raised ml-0" ng-click="vm.addRefund();" ng-if="vm.showTab && (vm.currentState === vm.TRANSACTION.TRANSACTION_INVOICE_REFUND_STATE)">
          Add Refund
        </md-button>

      </div>
    </div>

  </div>

  <div class="content-card" layout="row" flex="100" ng-class="{'pt-80': !vm.showTab, 'pt-60': vm.showTab}">
    <div class="content cm-receiving-material-navbar" flex="100" layout="column">
      <!-- FORM WIZARD -->
      <!--<ms-form-wizard flex>-->
      <md-nav-bar md-selected-nav-item="vm.selectedNavItem" nav-bar-aria-label="supplierInvoice" ng-if="vm.showTab">
        <md-nav-item ng-repeat="item in vm.tabList" md-nav-sref="{{item.src}}" name="{{item.title}}">{{item.title}}</md-nav-item>
      </md-nav-bar>
      <md-content ui-view="tabContent" flex class="card" ng-class="{ 'padding-10': vm.showTab }"></md-content>
    </div>
  </div>

</div>
