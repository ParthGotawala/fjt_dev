<md-dialog aria-label="ProductionStock" class="cm-custom-label-common" cg-busy="{promise:vm.cgBusyLoading}" draggable>
  <form name="vm.frmTerminateOperation">
    <md-button id="btnRequireColValidation" type="submit" ng-hide="true"></md-button>
    <md-toolbar>
      <div class="md-toolbar-tools">
        <h2>Terminate & Transfer Work Order</h2>
        <span flex></span>
        <div layout="row" layout-align="center center">
          <popup-header-label label-data="vm.headerdata"></popup-header-label>
        </div>
        <md-button class="md-icon-button" ng-click="vm.cancel()">
          <md-icon role="img" md-font-icon="icon-close" class="material-icons mat-icon icon-close"></md-icon>
        </md-button>
      </div>
    </md-toolbar>
    <md-dialog-content class="customer-modal no-padding min-height-200" layout="column">
      <md-content flex="100" layout-wrap layout="row" class="padding-10-imp mh-5">
        <div class="font-size-12 md-accent-fg" layout="row" flex="100" ng-if="!vm.autoCompleteToWorkOrder.keyColumnId">
          <!--margin-top-20-->
          <ul>
            <li><span><b>{{vm.PUBLISHED_WORKORDER_WILL_APPEAR_HERE}}</b></span></li>
          </ul>
        </div>
        <div layout="row" flex="100" class="workorderblog cm-section-main border-0 mv-5">
          <div class="cm-section-inner ph-0-imp" flex="100">
            <table cellspacing="0" cellpadding="0" class="cm-table-input-main">
              <tbody>
                <tr>
                  <th><p class="label-container">{{vm.autoCompleteToWorkOrder.placeholderName}}<span>&nbsp;*</span></p></th>
                  <td>
                    <md-input-container ng-if="vm.autoCompleteToWorkOrder" class="autocompletecustom margin-bottom-0"
                                        flex="100">
                      <custom-auto-complete datalist="vm.allWorkorderOperationList"
                                            column-name="vm.autoCompleteToWorkOrder.columnName"
                                            controller-name="vm.autoCompleteToWorkOrder.controllerName"
                                            view-template-url="vm.autoCompleteToWorkOrder.viewTemplateURL"
                                            key-column-name="vm.autoCompleteToWorkOrder.keyColumnName"
                                            input-name="vm.autoCompleteToWorkOrder.inputName"
                                            placeholder-name="vm.autoCompleteToWorkOrder.placeholderName"
                                            key-column-id="vm.autoCompleteToWorkOrder.keyColumnId"
                                            is-required="vm.autoCompleteToWorkOrder.isRequired"
                                            is-addnew="vm.autoCompleteToWorkOrder.isAddnew"
                                            is-disabled="vm.autoCompleteToWorkOrder.isDisabled"
                                            on-select-callback-fn="vm.autoCompleteToWorkOrder.onSelectCallbackFn"
                                            is-refresh-disabled="true">
                      </custom-auto-complete>
                    </md-input-container>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <!--<md-input-container ng-if="vm.autoCompleteToWorkOrder" class="autocompletecustom margin-bottom-0"
                              flex="33">
              <custom-auto-complete datalist="vm.allWorkorderOperationList"
                                    column-name="vm.autoCompleteToWorkOrder.columnName"
                                    controller-name="vm.autoCompleteToWorkOrder.controllerName"
                                    view-template-url="vm.autoCompleteToWorkOrder.viewTemplateURL"
                                    key-column-name="vm.autoCompleteToWorkOrder.keyColumnName"
                                    input-name="vm.autoCompleteToWorkOrder.inputName"
                                    placeholder-name="vm.autoCompleteToWorkOrder.placeholderName"
                                    key-column-id="vm.autoCompleteToWorkOrder.keyColumnId"
                                    is-required="vm.autoCompleteToWorkOrder.isRequired"
                                    is-addnew="vm.autoCompleteToWorkOrder.isAddnew"
                                    is-disabled="vm.autoCompleteToWorkOrder.isDisabled"
                                    on-select-callback-fn="vm.autoCompleteToWorkOrder.onSelectCallbackFn"
                                    is-refresh-disabled="true">
              </custom-auto-complete>
          </md-input-container>-->
        </div>
        <div layout="row" flex="100" class="workorderblog" ng-if="vm.isTransferQty">
          <md-table-container flex="100">
            <table md-table class="md-data-table table-row-select">
              <thead md-head>
                <tr md-row>
                  <th md-column>
                    <p class="label-container">
                      <a tabindex="-1" class="cm-text-decoration" ng-click="vm.goToWorkorderList();">From {{vm.LabelConstant.Workorder.WO}}</a>
                    </p>
                  </th>
                  <th md-column>
                    <p class="label-container">
                      From {{vm.LabelConstant.Operation.OP}}
                    </p>
                  </th>
                  <th md-column md-numeric>
                    <p class="label-container">
                      Available Qty
                    </p>
                  </th>
                  <th md-column md-numeric>
                    <p class="label-container">
                      Transfer Qty
                    </p>
                  </th>
                  <th md-column>
                    <p class="label-container">
                      <a tabindex="-1" class="cm-text-decoration" ng-click="vm.goToWorkorderList();">To {{vm.LabelConstant.Workorder.WO}}</a>
                    </p>
                    <!--<a tabindex="-1" class="cm-text-decoration" ng-click="vm.goToWorkorderDetails(vm.selectedToWorkorder.woID);">{{vm.selectedToWorkorder.woNumber}}</a>-->
                  </th>
                  <th md-column>
                    <p class="label-container">
                      To  {{vm.LabelConstant.Operation.OP}}
                    </p>
                  </th>
                </tr>
              </thead>
              <tbody md-body>
                <tr md-row ng-repeat="item in vm.transferOperationQtyList">
                  <td md-cell class="padding-10">
                    <p class="label-container">
                      <a tabindex="-1" class="cm-text-decoration" ng-click="vm.goToWorkorderDetails(vm.woOPDetail.woID);">{{vm.woOPDetail.workorder.woNumber}}</a>
                    </p>
                  </td>
                  <td md-cell class="padding-10">
                    <p class="label-container">
                      <a tabindex="-1" class="cm-text-decoration" ng-click="vm.goToWorkorderOperationDetails(item.fromWOOPID);">{{item.fromWOOPName}}</a>
                    </p>
                  </td>
                  <td md-cell class="padding-10">
                    <label>{{item.readyStock}}</label>
                  </td>
                  <td md-cell class="padding-10">
                    <md-input-container class="md-block margin-bottom-0 margin-top-30" flex="100"
                                        md-no-float>
                      <input type="number" class="text-right" name="transferQty{{$index}}"
                             ng-model="item.transferQty" onkeypress="return OnlyNumeric(event)"
                             placeholder="Transfer Qty" required
                             ng-disabled="vm.woOPDetail.workorder.isOperationTrackBySerialNo" min="1"
                             max="{{item.readyStock}}">
                      <div ng-messages="vm.frmTerminateOperation['transferQty'+$index].$error"
                           role="alert">
                        <div ng-message="required">
                          <span>{{vm.CORE_MESSAGE_CONSTANT.REQUIRED}}</span>
                        </div>
                        <div ng-message="min">
                          <span>{{vm.CORE_MESSAGE_CONSTANT.INVALID}}</span>
                        </div>
                        <div ng-message="max">
                          <span>{{vm.CORE_MESSAGE_CONSTANT.INVALID}}</span>
                        </div>
                        <div ng-message="number">
                          <span>{{vm.CORE_MESSAGE_CONSTANT.INVALID}}</span>
                        </div>
                      </div>
                    </md-input-container>
                  </td>
                  <td md-cell class="padding-10">
                    <p class="label-container">
                      <a tabindex="-1" class="cm-text-decoration" ng-click="vm.goToWorkorderDetails(vm.selectedToWorkorder.woID);">{{vm.selectedToWorkorder.woNumber}}</a>
                    </p>
                  </td>
                  <td md-cell class="padding-10">
                    <label><a tabindex="-1" class="cm-text-decoration" ng-click="vm.goToWorkorderOperationDetails(vm.getWOOPIDFromSelectedOP(item.autoCompleteToOperation.keyColumnId));">{{vm.getOpName(item.autoCompleteToOperation.keyColumnId)}}</a></label>
                    <md-input-container class="autocompletecustom margin-bottom-0" flex="100"
                                        md-no-float ng-hide="true">
                      <custom-auto-complete datalist="vm.toOperationList"
                                            column-name="item.autoCompleteToOperation.columnName"
                                            controller-name="item.autoCompleteToOperation.controllerName"
                                            view-template-url="item.autoCompleteToOperation.viewTemplateURL"
                                            key-column-name="item.autoCompleteToOperation.keyColumnName"
                                            input-name="item.autoCompleteToOperation.inputName"
                                            placeholder-name="item.autoCompleteToOperation.placeholderName"
                                            key-column-id="item.autoCompleteToOperation.keyColumnId"
                                            is-required="true" is-disabled="true">
                      </custom-auto-complete>
                    </md-input-container>
                  </td>
                </tr>
              </tbody>
            </table>
          </md-table-container>
        </div>
        <div layout="row" flex="100" ng-if="vm.isTransferQty" class="mt-20">
          <md-input-container class="md-block margin-0 p-0-imp" flex="100">
            <div layout="column" flex="100">
              <span ng-style="{'color':vm.frmTerminateOperation.data.$error.taMaxText?'red':''}">Comment</span>
              <span class="margin-bottom-10" ng-if="vm.frmTerminateOperation.data.$error.taMaxText"
                    style="color:red; font-size:12px">{{vm.CORE_MESSAGE_CONSTANT.MAX_LENGTH}}</span>
            </div>
            <text-angular ta-toolbar="vm.taToolbar.INLINE" ng-model="vm.comment" name="data" cg-busy-loading="vm.cgBusyLoading"
                          ng-class="{'text-angular-custom-border':vm.frmTerminateOperation.data.$error.taMaxText}"
                          ta-max-text="{{vm.taToolbar.MAX_LENGTH}}"></text-angular>
          </md-input-container>
        </div>

        <div class="empty-state text-center full-height" layout="row" layout-align="center center" flex="100"
             layout-wrap ng-if="vm.isTransferQty === false">
          <div class="emty-icon" flex="100">
            <img ng-src="{{vm.EmptyMesssage.IMAGEURL}}" />
          </div>
          <p flex="100" class="empty-state-title">{{vm.EmptyMesssage.MESSAGE}}</p>
        </div>
      </md-content>
    </md-dialog-content>
    <md-dialog-actions layout="row" layout-align="space-between center">
      <div>
        <md-button class="md-primary md-raised" ng-click="vm.getWorkorderTransferHistory($event, vm.fromWOOPID)"
                   ng-if="vm.fromWOOPID">History</md-button>
      </div>
      <div>
        <md-button class="md-default md-raised" ng-click="vm.cancel()">Cancel</md-button>
        <md-button class="md-primary md-raised" ng-click="vm.save()"
                   ng-class="{'md-formdirty': vm.checkFormDirty(vm.frmTerminateOperation,null)}">
          Transfer
        </md-button>
      </div>
    </md-dialog-actions>
  </form>
</md-dialog>
